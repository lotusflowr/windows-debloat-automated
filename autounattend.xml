<?xml version="1.0" encoding="utf-8"?>
<unattend xmlns="urn:schemas-microsoft-com:unattend" xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State">
	<!--https://schneegans.de/windows/unattend-generator/?LanguageMode=Unattended&UILanguage=en-US&Locale=en-CA&Keyboard=00011009&GeoLocation=39&ProcessorArchitecture=amd64&BypassRequirementsCheck=true&BypassNetworkCheck=true&UseConfigurationSet=true&HidePowerShellWindows=true&ComputerNameMode=Script&ComputerNameScript=%23+Generate+a+computer+name+in+the+format%3A+WIN%5B10%2F11%2FXX%5D-%5B3+random+alphanumeric+characters%5D%0D%0A%23+Example%3A+WIN10-4F6%2C+WIN11-XZ2%0D%0A%0D%0A%24osVersion+%3D+%28Get-CimInstance+Win32_OperatingSystem%29.Version.Split%28%27.%27%29%5B0%5D%0D%0A%24randomSuffix+%3D+-join+%28%2865..90+%2B+48..57%29+%7C+Get-Random+-Count+3+%7C+ForEach-Object+%7B+%5Bchar%5D%24_+%7D%29%0D%0Areturn+%22WIN%24osVersion-%24randomSuffix%22%0D%0A%0D%0A%3C%23%0D%0A+CURRENTLY+DISABLED+DUE+TO+LONG+DELAYS+DURING+WINDOWS+INSTALLATION%0D%0A%23+Generates+a+computer+name+like%3A%0D%0A%23+WIN10-ABC%2C+WIN11-XYZ%2C+WINSRV19-Q7P%2C+WINSRV25-T6L%0D%0A%0D%0A%23+Get+the+OS+product+name+%28e.g.%2C+%22Windows+Server+2022+Standard%22%29%0D%0A%24productName+%3D+%28Get-ItemProperty+%27HKLM%3A%5CSOFTWARE%5CMicrosoft%5CWindows+NT%5CCurrentVersion%27%29.ProductName%0D%0A%0D%0A%23+Initialize+prefix%0D%0A%24prefix+%3D+%22WIN%3F%3F%22%0D%0A%0D%0A%23+Try+to+extract+4-digit+year+if+present+%28e.g.%2C+2019%2C+2022%2C+2025%29%0D%0Aif+%28%24productName+-like+%22*Server*%22%29+%7B%0D%0A++++if+%28%24productName+-match+%2220%5Cd%7B2%7D%22%29+%7B%0D%0A++++++++%24year+%3D+%24Matches%5B0%5D%0D%0A++++++++%24prefix+%3D+%22WINSRV%24%28%24year.Substring%282%29%29%22++%23+use+last+two+digits+%28e.g.%2C+%2222%22%29%0D%0A++++%7D+else+%7B%0D%0A++++++++%24prefix+%3D+%22WINSRV%22%0D%0A++++%7D%0D%0A%7D%0D%0Aelseif+%28%24productName+-match+%22Windows+%28%5Cd%2B%29%22%29+%7B%0D%0A++++%24prefix+%3D+%22WIN%24%28%24Matches%5B1%5D%29%22%0D%0A%7D%0D%0A%0D%0A%23+Generate+random+3-character+alphanumeric+suffix+%28A%E2%80%93Z%2C+0%E2%80%939%29%0D%0A%24random+%3D+-join+%28%2865..90+%2B+48..57%29+%7C+Get-Random+-Count+3+%7C+ForEach-Object+%7B+%5Bchar%5D%24_+%7D%29%0D%0A%0D%0A%23+Return+computer+name%0D%0Areturn+%22%24prefix-%24random%22%0D%0A%0D%0A%23%3E&CompactOsMode=Default&TimeZoneMode=Implicit&PartitionMode=Unattended&PartitionLayout=GPT&EspSize=300&RecoveryMode=Partition&RecoverySize=1000&DiskAssertionMode=Script&DiskAssertionScript=On+Error+Resume+Next%0D%0ASet+wmi+%3D+GetObject%28%22winmgmts%3A%5C%5C.%5Croot%5Ccimv2%22%29%0D%0ASet+drive+%3D+wmi.Get%28%22Win32_DiskDrive.DeviceID%3D%27%5C%5C.%5CPHYSICALDRIVE0%27%22%29%0D%0AIf+Err.Number+%3C%3E+0+Then%0D%0A++++Msgbox+Err.Description%0D%0A++++WScript.Quit+1%0D%0AEnd+If%0D%0AIf+drive.InterfaceType+%3D+%22IDE%22+Or+drive.InterfaceType+%3D+%22SCSI%22+Then%0D%0A++++WScript.Quit+0%0D%0AElse%0D%0A++++MsgBox+%22Assertion+failed.%22%0D%0A++++WScript.Quit+1%0D%0AEnd+If&WindowsEditionMode=Generic&WindowsEdition=pro&InstallFromMode=Automatic&UserAccountMode=Unattended&AccountName0=user&AccountDisplayName0=&AccountPassword0=root&AccountGroup0=Administrators&AutoLogonMode=Own&PasswordExpirationMode=Unlimited&LockoutMode=Default&HideFiles=HiddenSystem&ShowFileExtensions=true&ClassicContextMenu=true&LaunchToThisPC=true&TaskbarSearch=Icon&TaskbarIconsMode=Default&DisableWidgets=true&LeftTaskbar=true&HideTaskViewButton=true&DisableBingResults=true&StartTilesMode=Empty&StartPinsMode=Empty&DisableWindowsUpdate=true&DisableSmartScreen=true&DisableFastStartup=true&DisableSystemRestore=true&EnableLongPaths=true&PreventAutomaticReboot=true&DisableAppSuggestions=true&HideEdgeFre=true&MakeEdgeUninstallable=true&DisablePointerPrecision=true&EffectsMode=Custom&ControlAnimations=true&DWMAeroPeekEnabled=true&SelectionFade=true&DWMSaveThumbnailEnabled=true&ListviewShadow=true&ThumbnailsOrIcon=true&ListviewAlphaSelect=true&ComboBoxAnimation=true&FontSmoothing=true&ListBoxSmoothScrolling=true&DesktopIconsMode=Custom&IconControlPanel=true&IconRecycleBin=true&VMwareTools=true&VirtIoGuestTools=true&WifiMode=Skip&ExpressSettings=DisableAll&KeysMode=Configure&CapsLockInitial=Off&CapsLockBehavior=Toggle&NumLockInitial=On&NumLockBehavior=Toggle&ScrollLockInitial=Off&ScrollLockBehavior=Toggle&StickyKeysMode=Default&ColorMode=Custom&SystemColorTheme=Dark&AppsColorTheme=Dark&AccentColor=%23cf05a7&WallpaperMode=Default&Remove3DViewer=true&RemoveBingSearch=true&RemoveCalculator=true&RemoveCamera=true&RemoveClipchamp=true&RemoveClock=true&RemoveCopilot=true&RemoveCortana=true&RemoveDevHome=true&RemoveFamily=true&RemoveFeedbackHub=true&RemoveGetHelp=true&RemoveHandwriting=true&RemoveInternetExplorer=true&RemoveMailCalendar=true&RemoveMaps=true&RemoveMathInputPanel=true&RemoveMediaFeatures=true&RemoveMixedReality=true&RemoveZuneVideo=true&RemoveNews=true&RemoveNotepad=true&RemoveOffice365=true&RemoveOneDrive=true&RemoveOneNote=true&RemoveOneSync=true&RemoveOpenSSHClient=true&RemoveOutlook=true&RemovePaint=true&RemovePaint3D=true&RemovePeople=true&RemovePhotos=true&RemovePowerAutomate=true&RemovePowerShell2=true&RemoveQuickAssist=true&RemoveRecall=true&RemoveRdpClient=true&RemoveSkype=true&RemoveSolitaire=true&RemoveSpeech=true&RemoveStepsRecorder=true&RemoveStickyNotes=true&RemoveTeams=true&RemoveGetStarted=true&RemoveToDo=true&RemoveVoiceRecorder=true&RemoveWallet=true&RemoveWeather=true&RemoveFaxAndScan=true&RemoveWindowsHello=true&RemoveWindowsMediaPlayer=true&RemoveZuneMusic=true&RemoveWordPad=true&RemoveXboxApps=true&RemoveYourPhone=true&SystemScript0=%23+Windows+Debloat+-+System+Setup+Script%0D%0A%23+Applies+system+tweaks+for+performance%2C+telemetry+reduction%2C+and+gaming%0D%0A%0D%0A%24logDir+%3D+Join-Path+%24env%3ATEMP+%22WinDebloatLogs%22%0D%0Aif+%28-not+%28Test-Path+%24logDir%29%29+%7B+New-Item+-ItemType+Directory+-Path+%24logDir+-Force+%7C+Out-Null+%7D%0D%0A%24timestamp+%3D+Get-Date+-Format+%22yyyyMMdd_HHmmss%22%0D%0AStart-Transcript+-Path+%28Join-Path+%24logDir+%2200_SystemSetup_%24timestamp.log%22%29+-Append+-Force%0D%0A%24start+%3D+Get-Date%0D%0A%0D%0Afunction+Write-LoggedOperation+%7B%0D%0A++++param+%28%5Bscriptblock%5D%24Block%2C+%5Bstring%5D%24Description%29%0D%0A++++Write-Host+%22%60n%5BINFO%5D+%24Description%22%0D%0A++++try+%7B+%26+%24Block%3B+Write-Host+%22%5BSUCCESS%5D+%24Description+completed%22+%7D+%0D%0A++++catch+%7B+Write-Host+%22%5BERROR%5D+%24Description+failed%3A+%24%28%24_.Exception.Message%29%22+%7D%0D%0A%7D%0D%0A%0D%0A%23+Windows+Update%0D%0AWrite-LoggedOperation+%7B%0D%0A++++reg.exe+add+%22HKLM%5CSOFTWARE%5CMicrosoft%5CWindows%5CCurrentVersion%5CDriverSearching%22+%2Fv+SearchOrderConfig+%2Ft+REG_DWORD+%2Fd+1+%2Ff%0D%0A%7D+%22Setting+Windows+Update+driver+search+priority%22%0D%0A%0D%0A%23+Disable+telemetry+tasks%0D%0AWrite-LoggedOperation+%7B%0D%0A++++%24tasks+%3D+%40%28%0D%0A++++++++%22Microsoft%5CWindows%5CApplication+Experience%5CMicrosoft+Compatibility+Appraiser%22%2C%0D%0A++++++++%22Microsoft%5CWindows%5CApplication+Experience%5CProgramDataUpdater%22%2C%0D%0A++++++++%22Microsoft%5CWindows%5CAutochk%5CProxy%22%2C%0D%0A++++++++%22Microsoft%5CWindows%5CCustomer+Experience+Improvement+Program%5CConsolidator%22%2C%0D%0A++++++++%22Microsoft%5CWindows%5CCustomer+Experience+Improvement+Program%5CUsbCeip%22%2C%0D%0A++++++++%22Microsoft%5CWindows%5CDiskDiagnostic%5CMicrosoft-Windows-DiskDiagnosticDataCollector%22%2C%0D%0A++++++++%22Microsoft%5CWindows%5CFeedback%5CSiuf%5CDmClient%22%2C%0D%0A++++++++%22Microsoft%5CWindows%5CFeedback%5CSiuf%5CDmClientOnScenarioDownload%22%2C%0D%0A++++++++%22Microsoft%5CWindows%5CWindows+Error+Reporting%5CQueueReporting%22%2C%0D%0A++++++++%22Microsoft%5CWindows%5CApplication+Experience%5CMareBackup%22%2C%0D%0A++++++++%22Microsoft%5CWindows%5CApplication+Experience%5CStartupAppTask%22%2C%0D%0A++++++++%22Microsoft%5CWindows%5CApplication+Experience%5CPcaPatchDbTask%22%2C%0D%0A++++++++%22Microsoft%5CWindows%5CMaps%5CMapsUpdateTask%22%2C%0D%0A++++++++%22Microsoft%5CWindows%5CWindows+Feeds%5CUpdateFeeds%22%0D%0A++++%29%0D%0A++++foreach+%28%24task+in+%24tasks%29+%7B+schtasks+%2FChange+%2FTN+%24task+%2FDisable+%7C+Out-Null+%7D%0D%0A%7D+%22Disabling+telemetry+tasks%22%0D%0A%0D%0A%23+Clear+telemetry+task+cache%0D%0AWrite-LoggedOperation+%7B%0D%0A++++%24taskGUIDs+%3D+%40%28%0D%0A++++++++%22%7B0600DD45-FAF2-4131-A006-0B17509B9F78%7D%22%2C+%23+Microsoft%5CWindows%5CApplication+Experience%5CMicrosoft+Compatibility+Appraiser%0D%0A++++++++%22%7B4738DE7A-BCC1-4E2D-B1B0-CADB044BFA81%7D%22%2C+%23+Microsoft%5CWindows%5CApplication+Experience%5CProgramDataUpdater%0D%0A++++++++%22%7B6FAC31FA-4A85-4E64-BFD5-2154FF4594B3%7D%22%2C+%23+Microsoft%5CWindows%5CApplication+Experience%5CStartupAppTask%0D%0A++++++++%22%7BFC931F16-B50A-472E-B061-B6F79A71EF59%7D%22%2C+%23+Microsoft%5CWindows%5CApplication+Experience%5CAitAgent%0D%0A++++++++%22%7B0671EB05-7D95-4153-A32B-1426B9FE61DB%7D%22%2C+%23+Microsoft%5CWindows%5CApplication+Experience%5CPcaPatchDbTask%0D%0A++++++++%22%7B87BF85F4-2CE1-4160-96EA-52F554AA28A2%7D%22%2C+%23+Microsoft%5CWindows%5CApplication+Experience%5CSdbinst%0D%0A++++++++%22%7B8A9C643C-3D74-4099-B6BD-9C6D170898B1%7D%22%2C+%23+Microsoft%5CWindows%5CApplication+Experience%5CMicrosoft+Compatibility+Appraiser%0D%0A++++++++%22%7BE3176A65-4E44-4ED3-AA73-3283660ACB9C%7D%22++%23+Microsoft%5CWindows%5CApplication+Experience%5CStartupAppTask%0D%0A++++%29%0D%0A++++foreach+%28%24guid+in+%24taskGUIDs%29+%7B+reg.exe+delete+%22HKLM%5CSOFTWARE%5CMicrosoft%5CWindows+NT%5CCurrentVersion%5CSchedule%5CTaskCache%5CTasks%5C%24guid%22+%2Ff+%7C+Out-Null+%7D%0D%0A%7D+%22Clearing+telemetry+task+cache%22%0D%0A%0D%0A%23+Power+%26+Performance%0D%0AWrite-LoggedOperation+%7B%0D%0A++++%24result+%3D+powercfg.exe+%2FDUPLICATESCHEME+e9a42b02-d5df-448d-aa00-03f14749eb61%0D%0A++++if+%28%24result+-match+%27%5Cs%28%5Ba-f0-9-%5D%7B36%7D%29%5Cs%27%29+%7B+powercfg.exe+%2FSETACTIVE+%24Matches%5B1%5D+%7D%0D%0A%7D+%22Activating+Ultimate+Performance+power+plan%22%0D%0A%0D%0AWrite-LoggedOperation+%7B%0D%0A++++reg.exe+add+%22HKLM%5CSYSTEM%5CCurrentControlSet%5CServices%5CLanmanServer%5CParameters%22+%2Fv+IRPStackSize+%2Ft+REG_DWORD+%2Fd+30+%2Ff%0D%0A%7D+%22Increasing+IRP+Stack+Size+for+better+network+performance%22%0D%0A%0D%0AWrite-LoggedOperation+%7B%0D%0A++++try+%7B%0D%0A++++++++%23+Calculate+optimal+svchost+split+threshold+based+on+system+RAM%0D%0A++++++++%24ramKB+%3D+%28Get-CimInstance+Win32_PhysicalMemory+%7C+Measure-Object+Capacity+-Sum%29.Sum+%2F+1KB%0D%0A++++++++if+%28%24ramKB+-le+0%29+%7B%0D%0A++++++++++++throw+%22Invalid+RAM+calculation+result%22%0D%0A++++++++%7D%0D%0A++++++++Set-ItemProperty+-Path+HKLM%3A%5CSYSTEM%5CCurrentControlSet%5CControl+-Name+SvcHostSplitThresholdInKB+-Value+%5Bint%5D%24ramKB+-Force%0D%0A++++%7D+catch+%7B%0D%0A++++++++throw+%22RAM+optimization+failed%3A+%24%28%24_.Exception.Message%29%22%0D%0A++++%7D%0D%0A%7D+%22Optimizing+svchost+split+threshold+based+on+system+RAM%22%0D%0A%23endregion%0D%0A%0D%0A%23+Power+settings%0D%0AWrite-LoggedOperation+%7B%0D%0A++++powercfg+-hibernate+off%0D%0A%0D%0A++++%23+Disable+standby+timeouts%0D%0A++++Write-Host+%22%E2%86%92+Disabling+AC+standby+timeout%22%0D%0A++++powercfg+%2Fchange+standby-timeout-ac+0%0D%0A%0D%0A++++Write-Host+%22%E2%86%92+Disabling+DC+standby+timeout%22%0D%0A++++powercfg+%2Fchange+standby-timeout-dc+0%0D%0A%0D%0A++++%23+Disable+monitor+timeouts%0D%0A++++Write-Host+%22%E2%86%92+Disabling+monitor+timeout+%28AC%29%22%0D%0A++++powercfg+%2Fchange+monitor-timeout-ac+0%0D%0A%0D%0A++++Write-Host+%22%E2%86%92+Disabling+monitor+timeout+%28DC%29%22%0D%0A++++powercfg+%2Fchange+monitor-timeout-dc+0%0D%0A%7D+%22Configuring+power+settings+for+maximum+performance%22%0D%0A%23endregion%0D%0A%0D%0A%23+Gaming+priority%0D%0AWrite-LoggedOperation+%7B%0D%0A++++reg.exe+add+%22HKLM%5CSOFTWARE%5CMicrosoft%5CWindows+NT%5CCurrentVersion%5CMultimedia%5CSystemProfile%5CTasks%5CGames%22+%2Fv+%22GPU+Priority%22+%2Ft+REG_DWORD+%2Fd+8+%2Ff%0D%0A++++reg.exe+add+%22HKLM%5CSOFTWARE%5CMicrosoft%5CWindows+NT%5CCurrentVersion%5CMultimedia%5CSystemProfile%5CTasks%5CGames%22+%2Fv+Priority+%2Ft+REG_DWORD+%2Fd+6+%2Ff%0D%0A++++reg.exe+add+%22HKLM%5CSOFTWARE%5CMicrosoft%5CWindows+NT%5CCurrentVersion%5CMultimedia%5CSystemProfile%5CTasks%5CGames%22+%2Fv+%22Scheduling+Category%22+%2Ft+REG_SZ+%2Fd+High+%2Ff%0D%0A%7D+%22Configuring+gaming+priority%22%0D%0A%0D%0A%23+Policy+hardening%0D%0AWrite-LoggedOperation+%7B%0D%0A++++reg.exe+add+%22HKLM%5CSOFTWARE%5CMicrosoft%5CWindows%5CWindows+Error+Reporting%22+%2Fv+Disabled+%2Ft+REG_DWORD+%2Fd+1+%2Ff%0D%0A%7D+%22Disabling+Windows+Error+Reporting%22%0D%0A%0D%0AWrite-LoggedOperation+%7B%0D%0A++++reg.exe+add+%22HKLM%5CSOFTWARE%5CPolicies%5CMicrosoft%5CWindows%5CAdvertisingInfo%22+%2Fv+DisabledByGroupPolicy+%2Ft+REG_DWORD+%2Fd+1+%2Ff%0D%0A%7D+%22Disabling+Advertising+ID+globally%22%0D%0A%0D%0AWrite-LoggedOperation+%7B%0D%0A++++reg.exe+add+%22HKLM%5CSOFTWARE%5CPolicies%5CMicrosoft%5CWindows%5CExplorer%22+%2Fv+NoPinningStoreToTaskbar+%2Ft+REG_DWORD+%2Fd+1+%2Ff%0D%0A%7D+%22Preventing+Microsoft+Store+from+being+pinned+to+taskbar%22%0D%0A%0D%0A%23+Start+menu+%26+feeds%0D%0AWrite-LoggedOperation+%7B%0D%0A++++reg.exe+add+%22HKLM%5CSOFTWARE%5CMicrosoft%5CPolicyManager%5CCurrent%5CDevice%5CStart%22+%2Fv+ConfigureStartPins+%2Ft+REG_SZ+%2Fd+%27%7B+%22pinnedList%22%3A+%5B%5D+%7D%27+%2Ff%0D%0A++++reg.exe+add+%22HKLM%5CSOFTWARE%5CMicrosoft%5CPolicyManager%5CCurrent%5CDevice%5CStart%22+%2Fv+ConfigureStartPins_ProviderSet+%2Ft+REG_DWORD+%2Fd+1+%2Ff%0D%0A++++reg.exe+add+%22HKLM%5CSOFTWARE%5CMicrosoft%5CPolicyManager%5CCurrent%5CDevice%5CStart%22+%2Fv+ConfigureStartPins_WinningProvider+%2Ft+REG_SZ+%2Fd+B5292708-1619-419B-9923-E5D9F3925E71+%2Ff%0D%0A%7D+%22Clearing+Start+menu+pinned+tiles%22%0D%0A%0D%0AWrite-LoggedOperation+%7B%0D%0A++++reg.exe+add+%22HKLM%5CSOFTWARE%5CPolicies%5CMicrosoft%5CWindows%5CWindows+Feeds%22+%2Fv+EnableFeeds+%2Ft+REG_DWORD+%2Fd+0+%2Ff%0D%0A%7D+%22Disabling+News+and+Interests+from+taskbar%22%0D%0A%0D%0A%23+Firewall%0D%0A%23Write-LoggedOperation+%7B%0D%0A%23++++New-NetFirewallRule+-DisplayName+%27ICMPv4%27+-Profile+Any+-Protocol+ICMPv4%0D%0A%23++++New-NetFirewallRule+-DisplayName+%27ICMPv6%27+-Profile+Any+-Protocol+ICMPv6%0D%0A%23%7D+%22Allowing+ICMP+ping%22%0D%0A%0D%0A%24runtime+%3D+%28Get-Date%29+-+%24start%0D%0AWrite-Host+%22%60nCompleted+in+%24%28%5Bmath%5D%3A%3ARound%28%24runtime.TotalSeconds%2C+2%29%29+seconds.%22%0D%0AStop-Transcript&SystemScriptType0=Ps1&FirstLogonScript0=%23+Windows+Debloat+-+UI+Tweaks+Script%0D%0A%23+Applies+Explorer+and+taskbar+behavior+tweaks+and+privacy+settings%0D%0A%0D%0A%24logDir+%3D+Join-Path+%24env%3ATEMP+%22WinDebloatLogs%22%0D%0Aif+%28-not+%28Test-Path+%24logDir%29%29+%7B+New-Item+-ItemType+Directory+-Path+%24logDir+-Force+%7C+Out-Null+%7D%0D%0A%24timestamp+%3D+Get-Date+-Format+%22yyyyMMdd_HHmmss%22%0D%0AStart-Transcript+-Path+%28Join-Path+%24logDir+%2201_UI_Tweaks_%24timestamp.log%22%29+-Append+-Force%0D%0A%24start+%3D+Get-Date%0D%0A%0D%0Afunction+Write-LoggedOperation+%7B%0D%0A++++param+%28%5Bscriptblock%5D%24Block%2C+%5Bstring%5D%24Description%29%0D%0A++++Write-Host+%22%60n%5BINFO%5D+%24Description%22%0D%0A++++try+%7B+%26+%24Block%3B+Write-Host+%22%5BSUCCESS%5D+%24Description+completed%22+%7D+%0D%0A++++catch+%7B+Write-Host+%22%5BERROR%5D+%24Description+failed%3A+%24%28%24_.Exception.Message%29%22+%7D%0D%0A%7D%0D%0A%0D%0A%23+Explorer+%26+UI+Tweaks%0D%0AWrite-LoggedOperation+%7B%0D%0A++++%23+Taskbar+and+Widgets%0D%0A++++Write-Host+%22%E2%86%92+Removing+Widgets%22%0D%0A++++reg.exe+add+%22HKCU%5CSoftware%5CMicrosoft%5CWindows%5CCurrentVersion%5CExplorer%5CAdvanced%22+%2Fv+TaskbarDa+%2Ft+REG_DWORD+%2Fd+0+%2Ff%0D%0A%0D%0A++++%23+Notepad+Settings%0D%0A++++Write-Host+%22%E2%86%92+Removing+Store+banner+in+Notepad%22%0D%0A++++reg.exe+add+%22HKCU%5CSOFTWARE%5CMicrosoft%5CNotepad%22+%2Fv+ShowStoreBanner+%2Ft+REG_DWORD+%2Fd+0+%2Ff%0D%0A%0D%0A++++%23+File+Explorer+Behavior%0D%0A++++Write-Host+%22%E2%86%92+Setting+File+Explorer+to+open+%27This+PC%27%22%0D%0A++++reg.exe+add+%22HKCU%5CSOFTWARE%5CMicrosoft%5CWindows%5CCurrentVersion%5CExplorer%5CAdvanced%22+%2Fv+LaunchTo+%2Ft+REG_DWORD+%2Fd+1+%2Ff%0D%0A%0D%0A++++%23+Alt%2BTab+Behavior%0D%0A++++Write-Host+%22%E2%86%92+Setting+Alt%2BTab+to+show+only+open+windows%22%0D%0A++++reg.exe+add+%22HKCU%5CSoftware%5CMicrosoft%5CWindows%5CCurrentVersion%5CExplorer%5CAdvanced%22+%2Fv+MultiTaskingAltTabFilter+%2Ft+REG_DWORD+%2Fd+3+%2Ff%0D%0A%0D%0A++++%23+Window+Management%0D%0A++++Write-Host+%22%E2%86%92+Disabling+Snap+Assist+Flyout%22%0D%0A++++reg.exe+add+%22HKCU%5CSOFTWARE%5CMicrosoft%5CWindows%5CCurrentVersion%5CExplorer%5CAdvanced%22+%2Fv+SnapAssist+%2Ft+REG_DWORD+%2Fd+0+%2Ff%0D%0A%0D%0A++++%23+Store+Integration%0D%0A++++Write-Host+%22%E2%86%92+Preventing+Store+app+pinning+to+taskbar%22%0D%0A++++reg.exe+add+%22HKCU%5CSOFTWARE%5CPolicies%5CMicrosoft%5CWindows%5CExplorer%22+%2Fv+NoPinningStoreToTaskbar+%2Ft+REG_DWORD+%2Fd+1+%2Ff%0D%0A%7D+%22Applying+File+Explorer+and+taskbar+behavior+tweaks%22%0D%0A%23endregion%0D%0A%0D%0A%23+Desktop+cleanup%0D%0AWrite-LoggedOperation+%7B%0D%0A++++Remove-Item+%22%24env%3AUSERPROFILE%5CDesktop%5CMicrosoft+Edge.lnk%22+-Force+-ErrorAction+SilentlyContinue%0D%0A%7D+%22Removing+Microsoft+Edge+shortcut+from+Desktop%22%0D%0A%0D%0A%23+Taskbar+icons+%26+news%0D%0AWrite-LoggedOperation+%7B%0D%0A++++%23+News+and+Interests+Panel%0D%0A++++Write-Host+%22%E2%86%92+Disabling+News+and+Interests+panel%22%0D%0A++++reg.exe+add+%22HKCU%5CSoftware%5CMicrosoft%5CWindows%5CCurrentVersion%5CFeeds%22+%2Fv+ShellFeedsEnabled+%2Ft+REG_DWORD+%2Fd+0+%2Ff%0D%0A%0D%0A++++%23+News+and+Interests+Hover%0D%0A++++Write-Host+%22%E2%86%92+Disabling+News+and+Interests+hover+popup%22%0D%0A++++reg.exe+add+%22HKCU%5CSoftware%5CMicrosoft%5CWindows%5CCurrentVersion%5CFeeds%22+%2Fv+ShellFeedsTaskbarOpenOnHover+%2Ft+REG_DWORD+%2Fd+0+%2Ff%0D%0A%0D%0A++++%23+Meet+Now+Button%0D%0A++++Write-Host+%22%E2%86%92+Hiding+Meet+Now+button+from+taskbar%22%0D%0A++++reg.exe+add+%22HKCU%5CSOFTWARE%5CMicrosoft%5CWindows%5CCurrentVersion%5CPolicies%5CExplorer%22+%2Fv+HideSCAMeetNow+%2Ft+REG_DWORD+%2Fd+1+%2Ff%0D%0A%7D+%22Disabling+taskbar+news%2C+widgets%2C+and+chat+icons%22%0D%0A%0D%0A%23+Privacy+%26+telemetry%0D%0AWrite-LoggedOperation+%7B%0D%0A++++%23+Language+and+Personalization%0D%0A++++Write-Host+%22%E2%86%92+Disabling+language+list+sharing+with+websites%22%0D%0A++++reg.exe+add+%22HKCU%5CControl+Panel%5CInternational%5CUser+Profile%22+%2Fv+HttpAcceptLanguageOptOut+%2Ft+REG_DWORD+%2Fd+1+%2Ff%0D%0A%0D%0A++++Write-Host+%22%E2%86%92+Disabling+personalization+consent%22%0D%0A++++reg.exe+add+%22HKCU%5CSOFTWARE%5CMicrosoft%5CPersonalization%5CSettings%22+%2Fv+AcceptedPrivacyPolicy+%2Ft+REG_DWORD+%2Fd+0+%2Ff%0D%0A%0D%0A++++%23+Input+Collection%0D%0A++++Write-Host+%22%E2%86%92+Disabling+collection+of+typed+text+and+handwriting%22%0D%0A++++reg.exe+add+%22HKCU%5CSOFTWARE%5CMicrosoft%5CWindows%5CCurrentVersion%5CInputPersonalization%22+%2Fv+RestrictImplicitTextCollection+%2Ft+REG_DWORD+%2Fd+1+%2Ff%0D%0A++++reg.exe+add+%22HKCU%5CSOFTWARE%5CMicrosoft%5CWindows%5CCurrentVersion%5CInputPersonalization%22+%2Fv+RestrictImplicitInkCollection+%2Ft+REG_DWORD+%2Fd+1+%2Ff%0D%0A%0D%0A++++%23+Feedback+and+Telemetry%0D%0A++++Write-Host+%22%E2%86%92+Disabling+feedback+sampling+and+related+services%22%0D%0A++++reg.exe+add+%22HKCU%5CSOFTWARE%5CMicrosoft%5CWindows%5CCurrentVersion%5CFeedback%22+%2Fv+AutoSample+%2Ft+REG_DWORD+%2Fd+0+%2Ff%0D%0A++++reg.exe+add+%22HKCU%5CSOFTWARE%5CMicrosoft%5CWindows%5CCurrentVersion%5CFeedback%22+%2Fv+ServiceEnabled+%2Ft+REG_DWORD+%2Fd+0+%2Ff%0D%0A%0D%0A++++%23+Telemetry+and+Advertising%0D%0A++++Write-Host+%22%E2%86%92+Disabling+telemetry+and+advertising+ID+features%22%0D%0A++++reg.exe+add+%22HKCU%5CSOFTWARE%5CMicrosoft%5CSiuf%5CRules%22+%2Fv+NumberOfSIUFInPeriod+%2Ft+REG_DWORD+%2Fd+0+%2Ff%0D%0A++++reg.exe+add+%22HKCU%5CSOFTWARE%5CPolicies%5CMicrosoft%5CWindows%5CCloudContent%22+%2Fv+DisableTailoredExperiencesWithDiagnosticData+%2Ft+REG_DWORD+%2Fd+1+%2Ff%0D%0A++++reg.exe+add+%22HKCU%5CSOFTWARE%5CPolicies%5CMicrosoft%5CWindows%5CCloudContent%22+%2Fv+DisableWindowsConsumerFeatures+%2Ft+REG_DWORD+%2Fd+1+%2Ff%0D%0A++++reg.exe+add+%22HKCU%5CSOFTWARE%5CMicrosoft%5CWindows%5CCurrentVersion%5CAdvertisingInfo%22+%2Fv+Enabled+%2Ft+REG_DWORD+%2Fd+0+%2Ff%0D%0A%7D+%22Applying+privacy+and+telemetry+restrictions%22%0D%0A%23endregion%0D%0A%0D%0A%23region+Telemetry+%26+Customer+Experience%0D%0A%23+%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0D%0A%23+Customer+Experience+and+Telemetry+Settings%0D%0A%23+%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%0D%0AWrite-LoggedOperation+%7B%0D%0A++++%23+Disable+Customer+Experience+Improvement+Program%0D%0A++++Write-Host+%22%E2%86%92+Disabling+Customer+Experience+Improvement+Program%22%0D%0A++++reg.exe+add+%22HKLM%5CSOFTWARE%5CPolicies%5CMicrosoft%5CSQMClient%22+%2Fv+CEIPEnable+%2Ft+REG_DWORD+%2Fd+0+%2Ff%0D%0A%0D%0A++++%23+Disable+Application+Telemetry%0D%0A++++Write-Host+%22%E2%86%92+Disabling+Application+Telemetry%22%0D%0A++++reg.exe+add+%22HKLM%5CSOFTWARE%5CPolicies%5CMicrosoft%5CWindows%5CAppCompat%22+%2Fv+AITEnable+%2Ft+REG_DWORD+%2Fd+0+%2Ff%0D%0A%0D%0A++++%23+Disable+Inventory+Collection%0D%0A++++Write-Host+%22%E2%86%92+Disabling+Inventory+Collection%22%0D%0A++++reg.exe+add+%22HKLM%5CSOFTWARE%5CPolicies%5CMicrosoft%5CWindows%5CAppCompat%22+%2Fv+DisableInventory+%2Ft+REG_DWORD+%2Fd+1+%2Ff%0D%0A%0D%0A++++%23+Disable+Program+Compatibility+Assistant%0D%0A++++Write-Host+%22%E2%86%92+Disabling+Program+Compatibility+Assistant%22%0D%0A++++reg.exe+add+%22HKLM%5CSOFTWARE%5CPolicies%5CMicrosoft%5CWindows%5CAppCompat%22+%2Fv+DisablePCA+%2Ft+REG_DWORD+%2Fd+1+%2Ff%0D%0A%0D%0A++++%23+Disable+Application+Telemetry%0D%0A++++Write-Host+%22%E2%86%92+Disabling+Application+Telemetry%22%0D%0A++++reg.exe+add+%22HKLM%5CSOFTWARE%5CPolicies%5CMicrosoft%5CWindows%5CAppCompat%22+%2Fv+DisableUAR+%2Ft+REG_DWORD+%2Fd+1+%2Ff%0D%0A%7D+%22Disabling+telemetry+and+customer+experience+tasks%22%0D%0A%0D%0A%24runtime+%3D+%28Get-Date%29+-+%24start%0D%0AWrite-Host+%22%60nCompleted+in+%24%28%5Bmath%5D%3A%3ARound%28%24runtime.TotalSeconds%2C+2%29%29+seconds.%22%0D%0AStop-Transcript&FirstLogonScriptType0=Ps1&FirstLogonScript1=%23+Windows+Debloat+-+SysPrep+Debloater+Script%0D%0A%23+Removes+bloatware+and+unnecessary+components+from+Windows%0D%0A%0D%0A%24logDir+%3D+Join-Path+%24env%3ATEMP+%22WinDebloatLogs%22%0D%0Aif+%28-not+%28Test-Path+%24logDir%29%29+%7B+New-Item+-ItemType+Directory+-Path+%24logDir+-Force+%7C+Out-Null+%7D%0D%0A%24timestamp+%3D+Get-Date+-Format+%22yyyyMMdd_HHmmss%22%0D%0AStart-Transcript+-Path+%28Join-Path+%24logDir+%2202_SysPrep_Debloater_%24timestamp.log%22%29+-Append+-Force%0D%0A%24start+%3D+Get-Date%0D%0A%0D%0Afunction+Write-LoggedOperation+%7B%0D%0A++++param+%28%5Bscriptblock%5D%24Block%2C+%5Bstring%5D%24Description%29%0D%0A++++Write-Host+%22%60n%5BINFO%5D+%24Description%22%0D%0A++++try+%7B+%26+%24Block%3B+Write-Host+%22%5BSUCCESS%5D+%24Description+completed%22+%7D+%0D%0A++++catch+%7B+Write-Host+%22%5BERROR%5D+%24Description+failed%3A+%24%28%24_.Exception.Message%29%22+%7D%0D%0A%7D%0D%0A%0D%0A%23+App+removal%0D%0AWrite-LoggedOperation+%7B%0D%0A++++%24appsToRemove+%3D+%40%28%0D%0A++++++++%27Microsoft.Microsoft3DViewer%27%0D%0A++++++++%27Microsoft.BingSearch%27%0D%0A++++++++%27Microsoft.BingFinance%27%0D%0A++++++++%27Microsoft.BingSports%27%0D%0A++++++++%27Microsoft.BingNews%27%0D%0A++++++++%27Microsoft.BingWeather%27%0D%0A++++++++%27Microsoft.BingTravel%27%0D%0A++++++++%27Microsoft.BingFoodAndDrink%27%0D%0A++++++++%27Microsoft.BingHealthAndFitness%27%0D%0A++++++++%27Microsoft.BingTranslator%27%0D%0A++++++++%27Microsoft.Wallet%27%0D%0A++++++++%27Microsoft.WindowsCamera%27%0D%0A++++++++%27Clipchamp.Clipchamp%27%0D%0A++++++++%27Microsoft.549981C3F5F10%27%0D%0A++++++++%27*DevHome*%27%0D%0A++++++++%27MicrosoftCorporationII.MicrosoftFamily%27%0D%0A++++++++%27Microsoft.WindowsFeedbackHub%27%0D%0A++++++++%27Microsoft.GetHelp%27%0D%0A++++++++%27microsoft.windowscommunicationsapps%27%0D%0A++++++++%27Microsoft.WindowsMaps%27%0D%0A++++++++%27Microsoft.ZuneVideo%27%0D%0A++++++++%27Microsoft.MicrosoftOfficeHub%27%0D%0A++++++++%27Microsoft.Office.OneNote%27%0D%0A++++++++%27Microsoft.OutlookForWindows%27%0D%0A++++++++%27Microsoft.MSPaint%27%0D%0A++++++++%27Microsoft.People%27%0D%0A++++++++%27Microsoft.Windows.Photos%27%0D%0A++++++++%27Microsoft.PowerAutomateDesktop%27%0D%0A++++++++%27MicrosoftCorporationII.QuickAssist%27%0D%0A++++++++%27Microsoft.SkypeApp%27%0D%0A++++++++%27Microsoft.ScreenSketch%27%0D%0A++++++++%27Microsoft.MicrosoftSolitaireCollection%27%0D%0A++++++++%27MSTeams%27%0D%0A++++++++%27Microsoft.Getstarted%27%0D%0A++++++++%27Microsoft.WindowsSoundRecorder%27%0D%0A++++++++%27Microsoft.ZuneMusic%27%0D%0A++++++++%27Microsoft.Xbox.TCUI%27%0D%0A++++++++%27Microsoft.XboxGameOverlay%27%0D%0A++++++++%27Microsoft.XboxGamingOverlay%27%0D%0A++++++++%27Microsoft.XboxSpeechToTextOverlay%27%0D%0A++++++++%27Microsoft.GamingApp%27%0D%0A++++++++%27Microsoft.YourPhone%27%0D%0A++++++++%27Microsoft.OneDrive%27%0D%0A++++++++%27Microsoft.MixedReality.Portal%27%0D%0A++++++++%27Microsoft.Windows.Ai.Copilot.Provider%27%0D%0A++++++++%27Microsoft.WindowsMeetNow%27%0D%0A++++++++%27Microsoft.Office.Lens%27%0D%0A++++++++%27*CandyCrush*%27%0D%0A++++++++%27*Netflix*%27%0D%0A++++%29%0D%0A%0D%0A++++foreach+%28%24app+in+%24appsToRemove%29+%7B%0D%0A++++++++Get-AppxPackage+-Name+%24app+-AllUsers+%7C+Remove-AppxPackage+-ErrorAction+SilentlyContinue%0D%0A++++%7D%0D%0A%7D+%22Removing+Windows+Store+apps%22%0D%0A%0D%0A%23+Service+disabling%0D%0AWrite-LoggedOperation+%7B%0D%0A++++%24servicesToDisable+%3D+%40%28%0D%0A++++++++%22DiagTrack%22%0D%0A++++++++%22dmwappushservice%22%0D%0A++++++++%22HomeGroupListener%22%0D%0A++++++++%22HomeGroupProvider%22%0D%0A++++++++%22lfsvc%22%0D%0A++++++++%22MapsBroker%22%0D%0A++++++++%22NetTcpPortSharing%22%0D%0A++++++++%22RemoteAccess%22%0D%0A++++++++%22RemoteRegistry%22%0D%0A++++++++%22SharedAccess%22%0D%0A++++++++%22TrkWks%22%0D%0A++++++++%22WbioSrvc%22%0D%0A++++++++%22WMPNetworkSvc%22%0D%0A++++++++%22WwanSvc%22%0D%0A++++%29%0D%0A%0D%0A++++foreach+%28%24service+in+%24servicesToDisable%29+%7B%0D%0A++++++++Stop-Service+-Name+%24service+-Force+-ErrorAction+SilentlyContinue%0D%0A++++++++Set-Service+-Name+%24service+-StartupType+Disabled+-ErrorAction+SilentlyContinue%0D%0A++++%7D%0D%0A%7D+%22Disabling+unnecessary+services%22%0D%0A%0D%0A%23+Task+removal%0D%0AWrite-LoggedOperation+%7B%0D%0A++++%24tasksToRemove+%3D+%40%28%0D%0A++++++++%22%5CMicrosoft%5CWindows%5CApplication+Experience%5CMicrosoft+Compatibility+Appraiser%22%0D%0A++++++++%22%5CMicrosoft%5CWindows%5CApplication+Experience%5CProgramDataUpdater%22%0D%0A++++++++%22%5CMicrosoft%5CWindows%5CApplication+Experience%5CStartupAppTask%22%0D%0A++++++++%22%5CMicrosoft%5CWindows%5CCustomer+Experience+Improvement+Program%5CConsolidator%22%0D%0A++++++++%22%5CMicrosoft%5CWindows%5CCustomer+Experience+Improvement+Program%5CUsbCeip%22%0D%0A++++++++%22%5CMicrosoft%5CWindows%5CDiskDiagnostic%5CMicrosoft-Windows-DiskDiagnosticDataCollector%22%0D%0A++++%29%0D%0A++++foreach+%28%24task+in+%24tasksToRemove%29+%7B%0D%0A++++++++Unregister-ScheduledTask+-TaskName+%24task+-Confirm%3A%24false+-ErrorAction+SilentlyContinue%0D%0A++++%7D%0D%0A%7D+%22Removing+scheduled+tasks%22%0D%0A%0D%0A%23+Cleanup%0D%0AWrite-LoggedOperation+%7B%0D%0A++++Stop-Service+-Name+wuauserv+-Force+-ErrorAction+SilentlyContinue%0D%0A++++Remove-Item+%22%24env%3Awindir%5CSoftwareDistribution%5C*%22+-Recurse+-Force+-ErrorAction+SilentlyContinue%0D%0A++++Start-Service+-Name+wuauserv+-ErrorAction+SilentlyContinue%0D%0A++++Remove-Item+%22%24env%3ATEMP%5C*%22+-Recurse+-Force+-ErrorAction+SilentlyContinue%0D%0A++++Remove-Item+%22%24env%3Awindir%5CTemp%5C*%22+-Recurse+-Force+-ErrorAction+SilentlyContinue%0D%0A%0D%0A++++%23+Clear+Windows+Error+Reports%0D%0A++++Remove-Item+%22%24env%3AProgramData%5CMicrosoft%5CWindows%5CWER%5C*%22+-Recurse+-Force+-ErrorAction+SilentlyContinue%0D%0A%7D+%22Cleaning+up+temporary+files%22%0D%0A%0D%0A%24runtime+%3D+%28Get-Date%29+-+%24start%0D%0AWrite-Host+%22%60nCompleted+in+%24%28%5Bmath%5D%3A%3ARound%28%24runtime.TotalSeconds%2C+2%29%29+seconds.%22%0D%0AStop-Transcript&FirstLogonScriptType1=Ps1&FirstLogonScript2=%23+Windows+Debloat+-+Winget+Application+Installation+Script%0D%0A%23+Installs+Winget+if+not+present+and+installs+a+set+of+applications%0D%0A%0D%0A%24logDir+%3D+Join-Path+%24env%3ATEMP+%22WinDebloatLogs%22%0D%0Aif+%28-not+%28Test-Path+%24logDir%29%29+%7B+New-Item+-ItemType+Directory+-Path+%24logDir+-Force+%7C+Out-Null+%7D%0D%0A%24timestamp+%3D+Get-Date+-Format+%22yyyyMMdd_HHmmss%22%0D%0AStart-Transcript+-Path+%28Join-Path+%24logDir+%2203_Winget_Apps_%24timestamp.log%22%29+-Append+-Force%0D%0A%24start+%3D+Get-Date%0D%0A%0D%0A%23+Configuration%0D%0A%24RemoveShortcuts+%3D+%24true%0D%0A%24appList+%3D+%40%28%0D%0A++++%22EpicGames.EpicGamesLauncher%22%0D%0A++++%22Valve.Steam%22%0D%0A++++%22Discord.Discord%22%0D%0A++++%22Spotify.Spotify%22%0D%0A++++%22Zen-Team.Zen-Browser%22%0D%0A++++%22Microsoft.WindowsTerminal%22%0D%0A++++%22voidtools.Everything%22%0D%0A%29%0D%0A%24shortcutFragments+%3D+%24appList+%7C+ForEach-Object+%7B+%28%24_+-split+%27%5C.%27%29%5B1%5D+%7D+%7C+Where-Object+%7B+%24_+%7D%0D%0A%0D%0Afunction+Write-LoggedOperation+%7B%0D%0A++++param+%28%0D%0A++++++++%5Bscriptblock%5D%24Block%2C%0D%0A++++++++%5Bstring%5D%24Description%0D%0A++++%29%0D%0A++++Write-Host+%22%60n%5BINFO%5D+%24Description%22%0D%0A++++try+%7B+%26+%24Block%3B+Write-Host+%22%5BSUCCESS%5D+%24Description+completed%22+%7D+%0D%0A++++catch+%7B+Write-Host+%22%5BERROR%5D+%24Description+failed%3A+%24%28%24_.Exception.Message%29%22+%7D%0D%0A%7D%0D%0A%0D%0Afunction+Remove-Shortcut+%7B%0D%0A++++param+%28%0D%0A++++++++%5BParameter%28Mandatory+%3D+%24true%29%5D%0D%0A++++++++%5Bstring%5B%5D%5D%24NameFragments%0D%0A++++%29%0D%0A%0D%0A++++%24shortcutPaths+%3D+%40%28%0D%0A++++++++%22%24env%3AUSERPROFILE%5CDesktop%22%2C%0D%0A++++++++%22C%3A%5CUsers%5CPublic%5CDesktop%22%0D%0A++++%29%0D%0A%0D%0A++++foreach+%28%24path+in+%24shortcutPaths%29+%7B%0D%0A++++++++foreach+%28%24fragment+in+%24NameFragments%29+%7B%0D%0A++++++++++++Get-ChildItem+-Path+%24path+-Filter+*.lnk+-ErrorAction+SilentlyContinue+%7C%0D%0A++++++++++++++++Where-Object+%7B+%24_.Name+-match+%5Bregex%5D%3A%3AEscape%28%24fragment%29+%7D+%7C%0D%0A++++++++++++++++ForEach-Object+%7B%0D%0A++++++++++++++++++++Write-Host+%22%60n%5BINFO%5D+Found+shortcut+matching+%27%24fragment%27%3A+%24%28%24_.FullName%29%22%0D%0A++++++++++++++++++++Write-LoggedOperation+%7B%0D%0A++++++++++++++++++++++++Remove-Item+%24_.FullName+-Force+-ErrorAction+SilentlyContinue%0D%0A++++++++++++++++++++%7D+%22Removing+shortcut%3A+%24%28%24_.Name%29%22%0D%0A++++++++++++++++%7D%0D%0A++++++++%7D%0D%0A++++%7D%0D%0A%7D%0D%0A%0D%0A%23+Path+setup%0D%0A%24VCLibs+++++++%3D+%22%24env%3ATEMP%5CMicrosoft.VCLibs.x64.14.00.Desktop.appx%22%0D%0A%24UIXaml+++++++%3D+%22%24env%3ATEMP%5CMicrosoft.UI.Xaml.2.8.x64.appx%22%0D%0A%24winget+++++++%3D+%22%24env%3ATEMP%5Cwinget.msixbundle%22%0D%0A%0D%0A%24VCLibsUrl++++%3D+%22https%3A%2F%2Faka.ms%2FMicrosoft.VCLibs.x64.14.00.Desktop.appx%22%0D%0A%24UIXamlUrl++++%3D+%22https%3A%2F%2Fgithub.com%2Fmicrosoft%2Fmicrosoft-ui-xaml%2Freleases%2Fdownload%2Fv2.8.6%2FMicrosoft.UI.Xaml.2.8.x64.appx%22%0D%0A%24wingetUrl++++%3D+%22https%3A%2F%2Fapi.github.com%2Frepos%2Fmicrosoft%2Fwinget-cli%2Freleases%2Flatest%22%0D%0A%0D%0A%23+Dependencies%0D%0AWrite-LoggedOperation+%7B%0D%0A++++%26+curl.exe+-L+-o+%24VCLibs+%24VCLibsUrl%0D%0A++++Add-AppxPackage+-Path+%24VCLibs%0D%0A%7D+%22Installing+Microsoft.VCLibs+%28UWP+C%2B%2B+runtime%29%22%0D%0A%0D%0AWrite-LoggedOperation+%7B%0D%0A++++%26+curl.exe+-L+-o+%24UIXaml+%24UIXamlUrl%0D%0A++++Add-AppxPackage+-Path+%24UIXaml%0D%0A%7D+%22Installing+Microsoft.UI.Xaml+%28UI+framework%29%22%0D%0A%0D%0A%23+Winget+installation%0D%0AWrite-LoggedOperation+%7B%0D%0A++++%5BNet.ServicePointManager%5D%3A%3ASecurityProtocol+%3D+%5BNet.SecurityProtocolType%5D%3A%3ATls12%0D%0A++++%24bundle+%3D+%28Invoke-RestMethod+%24wingetUrl%29.assets+%7C+Where-Object+%7B+%24_.name+-like+%22*.msixbundle%22+%7D+%7C+Select-Object+-First+1%0D%0A++++%26+curl.exe+-L+-J+-o+%24winget+%24bundle.browser_download_url%0D%0A++++if+%28-Not+%28Test-Path+%24winget%29%29+%7B+throw+%22Download+failed%3A+%24winget+was+not+created.%22+%7D%0D%0A++++Add-AppxPackage+-Path+%24winget%0D%0A%7D+%22Installing+winget+%28Windows+Package+Manager%29%22%0D%0A%0D%0A%23+Winget+verification%0D%0ASet-Variable+-Name+wingetAvailable+-Value+%24false+-Scope+Script%0D%0AWrite-LoggedOperation+%7B%0D%0A++++winget+%2D%2Dversion+%7C+Out-Null%0D%0A++++%24script%3AwingetAvailable+%3D+%24true%0D%0A%7D+%22Verifying+winget+is+available%22%0D%0A%0D%0A%23+Application+installation%0D%0Aif+%28%24wingetAvailable%29+%7B%0D%0A++++Write-LoggedOperation+%7B%0D%0A++++++++Remove-Item+-LiteralPath+%24winget+-Force+-ErrorAction+SilentlyContinue%0D%0A++++++++Remove-Item+-LiteralPath+%24UIXaml+-Force+-ErrorAction+SilentlyContinue%0D%0A++++++++Remove-Item+-LiteralPath+%24VCLibs+-Force+-ErrorAction+SilentlyContinue%0D%0A++++%7D+%22Cleaning+up+temporary+files%22%0D%0A%0D%0A++++%23+Install+applications%0D%0A++++foreach+%28%24app+in+%24appList%29+%7B%0D%0A++++++++Write-LoggedOperation+%7B%0D%0A++++++++++++winget+install+%2D%2Did%3D%24app+-e+%2D%2Daccept-source-agreements+%2D%2Daccept-package-agreements%0D%0A++++++++%7D+%22Installing+%24app%22%0D%0A++++%7D%0D%0A%0D%0A++++%23+Optional+shortcut+cleanup%0D%0A++++if+%28%24RemoveShortcuts%29+%7B%0D%0A++++++++Write-LoggedOperation+%7B%0D%0A++++++++++++Remove-Shortcut+-NameFragments+%24shortcutFragments%0D%0A++++++++%7D+%22Removing+desktop+shortcuts+for+installed+apps%22%0D%0A++++%7D%0D%0A%7D+else+%7B%0D%0A++++Write-Host+%22%60n%5BWARNING%5D+winget+is+not+available.+Skipping+app+installations+and+cleanup.%22%0D%0A%7D%0D%0A%0D%0A%24runtime+%3D+%28Get-Date%29+-+%24start%0D%0AWrite-Host+%22%60nCompleted+in+%24%28%5Bmath%5D%3A%3ARound%28%24runtime.TotalSeconds%2C+2%29%29+seconds.%22%0D%0AStop-Transcript&FirstLogonScriptType2=Ps1&FirstLogonScript3=%23+Windows+Debloat+-+User+Setup+Script%0D%0A%23+Configures+keyboard+layout%2C+wallpaper%2C+shortcuts%2C+and+Windows+activation%0D%0A%0D%0A%24logDir+%3D+Join-Path+%24env%3ATEMP+%22WinDebloatLogs%22%0D%0Aif+%28-not+%28Test-Path+%24logDir%29%29+%7B+New-Item+-ItemType+Directory+-Path+%24logDir+-Force+%7C+Out-Null+%7D%0D%0A%24timestamp+%3D+Get-Date+-Format+%22yyyyMMdd_HHmmss%22%0D%0AStart-Transcript+-Path+%28Join-Path+%24logDir+%2204_UserSetup_%24timestamp.log%22%29+-Append+-Force%0D%0A%24start+%3D+Get-Date%0D%0A%0D%0Afunction+Write-LoggedOperation+%7B%0D%0A++++param+%28%5Bscriptblock%5D%24Block%2C+%5Bstring%5D%24Description%29%0D%0A++++Write-Host+%22%60n%5BINFO%5D+%24Description%22%0D%0A++++try+%7B+%26+%24Block%3B+Write-Host+%22%5BSUCCESS%5D+%24Description+completed%22+%7D+%0D%0A++++catch+%7B+Write-Host+%22%5BERROR%5D+%24Description+failed%3A+%24%28%24_.Exception.Message%29%22+%7D%0D%0A%7D%0D%0A%0D%0A%23+Keyboard+layout%0D%0AWrite-LoggedOperation+%7B%0D%0A++++%23+To+customize%3A+Run+Get-WinUserLanguageList+to+view+input%2Flanguage+codes%0D%0A++++%23+Replace+%27en-CA%27+and+%271009%3A00011009%27+with+your+own+layout+if+desired%0D%0A++++%24langList+%3D+New-WinUserLanguageList+%22en-CA%22%0D%0A++++%24langList%5B0%5D.InputMethodTips.Clear%28%29%0D%0A++++%24langList%5B0%5D.InputMethodTips.Add%28%221009%3A00011009%22%29++%23+Canadian+Multilingual+Standard%0D%0A++++Set-WinUserLanguageList+%24langList+-Force%0D%0A%7D+%22Setting+keyboard+layout+to+English+%28Canada%29+-+Canadian+Multilingual%22%0D%0A%23endregion%0D%0A%0D%0A%23+Wallpaper%0D%0A%24W10_Wallpaper+%3D+%22C%3A%5CWindows%5CWeb%5CWallpaper%5CTheme1%5Cimg4.jpg%22%0D%0A%24W11_Wallpaper+%3D+%22C%3A%5CWindows%5CWeb%5CWallpaper%5CThemeA%5Cimg20.jpg%22%0D%0A%0D%0AWrite-LoggedOperation+%7B%0D%0A++++%24wallpaperToApply+%3D+if+%28Test-Path+%24W10_Wallpaper%29+%7B+%24W10_Wallpaper+%7D%0D%0A++++elseif+%28Test-Path+%24W11_Wallpaper%29+%7B+%24W11_Wallpaper+%7D%0D%0A++++else+%7B+return+%7D%0D%0A++++%0D%0A++++Set-ItemProperty+-Path+%27HKCU%3A%5CControl+Panel%5CDesktop%27+-Name+WallPaper+-Value+%24wallpaperToApply%0D%0A++++Set-ItemProperty+-Path+%27HKCU%3A%5CControl+Panel%5CDesktop%27+-Name+WallpaperStyle+-Value+%2210%22++%23+Fill%0D%0A++++Set-ItemProperty+-Path+%27HKCU%3A%5CControl+Panel%5CDesktop%27+-Name+TileWallpaper+-Value+%220%22+++++%23+No+Tile%0D%0A++++Start-Process+-FilePath+rundll32.exe+-ArgumentList+%27user32.dll%2CUpdatePerUserSystemParameters%27+-NoNewWindow+-Wait%0D%0A%7D+%22Applying+default+wallpaper%22%0D%0A%0D%0A%23+Shortcut+management%0D%0AWrite-LoggedOperation+%7B%0D%0A++++Remove-Item+%22%24env%3AUSERPROFILE%5CDesktop%5CMicrosoft+Edge.lnk%22+-Force+-ErrorAction+SilentlyContinue%0D%0A%7D+%22Removing+Microsoft+Edge+shortcut+from+Desktop%22%0D%0A%0D%0AWrite-LoggedOperation+%7B%0D%0A++++%24ncpa+%3D+%28New-Object+-ComObject+WScript.Shell%29.CreateShortcut%28%22%24env%3AUSERPROFILE%5CDesktop%5CNetwork+Connections.lnk%22%29%0D%0A++++%24ncpa.TargetPath+++++++%3D+%22%24env%3Awindir%5Cexplorer.exe%22%0D%0A++++%24ncpa.Arguments++++++++%3D+%22shell%3A%3A%3A%7B992CFFA0-F557-101A-88EC-00DD010CCC48%7D%22%0D%0A++++%24ncpa.WorkingDirectory+%3D+%22%24env%3Awindir%22%0D%0A++++%24ncpa.IconLocation+++++%3D+%22%24env%3ASystemRoot%5CSystem32%5Cnetshell.dll%22%0D%0A++++%24ncpa.Save%28%29%0D%0A%7D+%22Creating+%27Network+Connections%27+shortcut+on+Desktop%22%0D%0A%0D%0A%23+Startup+apps%0D%0AWrite-LoggedOperation+%7B%0D%0A++++reg.exe+delete+%22HKLM%5CSOFTWARE%5CMicrosoft%5CWindows%5CCurrentVersion%5CRun%22+%2Fv+SecurityHealth+%2Ff%0D%0A++++%0D%0A++++Write-Host+%22%E2%86%92+Removing+Edge+autolaunch+startup%22%0D%0A++++%24runKey+%3D+%22HKCU%5CSOFTWARE%5CMicrosoft%5CWindows%5CCurrentVersion%5CRun%22%0D%0A++++Get-ItemProperty+-Path+%22Registry%3A%3A%24runKey%22+%7C+%0D%0A++++++++Get-Member+-MemberType+NoteProperty+%7C%0D%0A++++++++Where-Object+%7B+%24_.Name+-like+%22MicrosoftEdgeAutoLaunch_*%22+%7D+%7C%0D%0A++++++++ForEach-Object+%7B+Remove-ItemProperty+-Path+%22Registry%3A%3A%24runKey%22+-Name+%24_.Name+-Force+%7D%0D%0A%7D+%22Setting+up+user+preferences%22%0D%0A%0D%0A%23+Tools%0D%0AWrite-LoggedOperation+%7B%0D%0A++++curl.exe+-L+-s+https%3A%2F%2Flive.sysinternals.com%2FAutologon.exe+-o+%22%24env%3AUSERPROFILE%5CDesktop%5CAutologon.exe%22%0D%0A%7D+%22Downloading+Sysinternals+Autologon+to+Desktop%22%0D%0A%0D%0A%23+Windows+activation%0D%0AWrite-LoggedOperation+%7B%0D%0A++++Write-Host+%22%5BDETAIL%5D+Downloading+and+running+TSForge+activation+script...%22%0D%0A++++%24tsPath+%3D+%22%24env%3ATEMP%5CTSforge_Activation.cmd%22%0D%0A++++curl.exe+-L+-s+https%3A%2F%2Fraw.githubusercontent.com%2Fmassgravel%2FMicrosoft-Activation-Scripts%2Fmaster%2FMAS%2FSeparate-Files-Version%2FActivators%2FTSforge_Activation.cmd+-o+%24tsPath%0D%0A++++%26+%24tsPath+%2FZ-Windows%0D%0A++++Remove-Item+%24tsPath+-Force+-ErrorAction+SilentlyContinue%0D%0A%7D+%22Running+TSForge+activation%22%0D%0A%0D%0AWrite-Host+%22%E2%86%92+Restarting+Explorer+to+apply+changes%22%0D%0Ataskkill+%2Ff+%2Fim+explorer.exe+%7C+Out-Null%0D%0AStart-Process+explorer.exe%0D%0A%0D%0A%24runtime+%3D+%28Get-Date%29+-+%24start%0D%0AWrite-Host+%22%60nCompleted+in+%24%28%5Bmath%5D%3A%3ARound%28%24runtime.TotalSeconds%2C+2%29%29+seconds.%22%0D%0AStop-Transcript&FirstLogonScriptType3=Ps1&FirstLogonScript4=%23+Windows+Debloat+-+Windows+Optimizer+Script%0D%0A%23+Downloads+and+runs+the+latest+Optimizer.exe+with+predefined+configurations%0D%0A%0D%0A%24logDir+%3D+Join-Path+%24env%3ATEMP+%22WinDebloatLogs%22%0D%0Aif+%28-not+%28Test-Path+%24logDir%29%29+%7B+New-Item+-ItemType+Directory+-Path+%24logDir+-Force+%7C+Out-Null+%7D%0D%0A%24timestamp+%3D+Get-Date+-Format+%22yyyyMMdd_HHmmss%22%0D%0AStart-Transcript+-Path+%28Join-Path+%24logDir+%2205_WindowsOptimizer_%24timestamp.log%22%29+-Append+-Force%0D%0A%24start+%3D+Get-Date%0D%0A%0D%0Afunction+Write-LoggedOperation+%7B%0D%0A++++param+%28%5Bscriptblock%5D%24Block%2C+%5Bstring%5D%24Description%29%0D%0A++++Write-Host+%22%60n%5BINFO%5D+%24Description%22%0D%0A++++try+%7B+%26+%24Block%3B+Write-Host+%22%5BSUCCESS%5D+%24Description+completed%22+%7D+%0D%0A++++catch+%7B+Write-Host+%22%5BERROR%5D+%24Description+failed%3A+%24%28%24_.Exception.Message%29%22+%7D%0D%0A%7D%0D%0A%0D%0A%23+Configuration%0D%0A%24configJson+%3D+%40%27%0D%0A%7B%0D%0A++++%22WindowsVersion%22%3A+%22__OSVERSION__%22%2C%0D%0A++++%22Tweaks%22%3A+%7B%0D%0A++++++++%22DisableTelemetry%22%3A+true%2C%0D%0A++++++++%22DisableErrorReporting%22%3A+true%2C%0D%0A++++++++%22DisableAdvertisingID%22%3A+true%2C%0D%0A++++++++%22DisableNewsAndInterests%22%3A+true%2C%0D%0A++++++++%22DisableStoreTaskbarPin%22%3A+true%2C%0D%0A++++++++%22DisableWidgets%22%3A+true%2C%0D%0A++++++++%22DisableFeedback%22%3A+true%2C%0D%0A++++++++%22DisableTailoredExperiences%22%3A+true%2C%0D%0A++++++++%22DisableConsumerFeatures%22%3A+true%2C%0D%0A++++++++%22DisableBackgroundApps%22%3A+true%2C%0D%0A++++++++%22DisableHibernation%22%3A+true%2C%0D%0A++++++++%22DisableNotifications%22%3A+true%2C%0D%0A++++++++%22DisableLocation%22%3A+true%2C%0D%0A++++++++%22DisableIPv6%22%3A+true%2C%0D%0A++++++++%22DisableSuggestedContent%22%3A+true%2C%0D%0A++++++++%22DisableSearchSuggestions%22%3A+true%2C%0D%0A++++++++%22DisableWiFiSense%22%3A+true%2C%0D%0A++++++++%22EnableUltimatePerformance%22%3A+true%2C%0D%0A++++++++%22HideTaskbarWeather%22%3A+true%2C%0D%0A++++++++%22DisableMyPeople%22%3A+true%2C%0D%0A++++++++%22EnableLongPaths%22%3A+true%2C%0D%0A++++++++%22DisableTPMCheck%22%3A+true%2C%0D%0A++++++++%22DisableSensorServices%22%3A+true%2C%0D%0A++++++++%22RemoveCastToDevice%22%3A+true%2C%0D%0A++++++++%22RestoreClassicPhotoViewer%22%3A+true%2C%0D%0A++++++++%22DisableModernStandby%22%3A+true%2C%0D%0A++++++++%22DisableAutomaticUpdates%22%3A+true%2C%0D%0A++++++++%22DisableStoreUpdates%22%3A+true%2C%0D%0A++++++++%22DisableInsiderService%22%3A+true%2C%0D%0A++++++++%22ExcludeDrivers%22%3A+true%2C%0D%0A++++++++%22DisableTelemetryServices%22%3A+true%2C%0D%0A++++++++%22DisableCortana%22%3A+true%2C%0D%0A++++++++%22DisablePrivacyOptions%22%3A+true%2C%0D%0A++++++++%22DisableStartMenuAds%22%3A+true%2C%0D%0A++++++++%22DisableEdgeTelemetry%22%3A+true%2C%0D%0A++++++++%22DisableEdgeDiscoverBar%22%3A+true%2C%0D%0A++++++++%22EnableGamingMode%22%3A+true%2C%0D%0A++++++++%22DisableXboxLive%22%3A+true%2C%0D%0A++++++++%22DisableGameBar%22%3A+true%2C%0D%0A++++++++%22DisableWindowsInk%22%3A+true%2C%0D%0A++++++++%22DisableSpellingTyping%22%3A+true%2C%0D%0A++++++++%22DisableCloudClipboard%22%3A+true%0D%0A++++%7D%2C%0D%0A++++%22AdvancedTweaks%22%3A+%7B%0D%0A++++++++%22SvchostProcessSplitting%22%3A+%7B%0D%0A++++++++++++%22Disable%22%3A+false%2C%0D%0A++++++++++++%22RAM%22%3A+null%0D%0A++++++++%7D%0D%0A++++%7D%2C%0D%0A++++%22Cleaner%22%3A+%7B%0D%0A++++++++%22RemovePUA%22%3A+true%2C%0D%0A++++++++%22RemoveOptionalFeatures%22%3A+true%2C%0D%0A++++++++%22RemoveOneDrive%22%3A+true%2C%0D%0A++++++++%22RemoveTeams%22%3A+true%0D%0A++++%7D%2C%0D%0A++++%22RegistryFix%22%3A+%7B%0D%0A++++++++%22TaskManager%22%3A+true%2C%0D%0A++++++++%22CommandPrompt%22%3A+true%2C%0D%0A++++++++%22ControlPanel%22%3A+true%2C%0D%0A++++++++%22FolderOptions%22%3A+true%2C%0D%0A++++++++%22RunDialog%22%3A+true%2C%0D%0A++++++++%22RightClickMenu%22%3A+true%2C%0D%0A++++++++%22WindowsFirewall%22%3A+true%2C%0D%0A++++++++%22RegistryEditor%22%3A+true%0D%0A++++%7D%2C%0D%0A++++%22Integrator%22%3A+%7B%0D%0A++++++++%22OpenWithCMD%22%3A+true%0D%0A++++%7D%2C%0D%0A++++%22PostAction%22%3A+%7B%0D%0A++++++++%22Restart%22%3A+true%2C%0D%0A++++++++%22RestartType%22%3A+%22Normal%22%0D%0A++++%7D%0D%0A%7D%0D%0A%27%40%0D%0A%0D%0A%23+Apply+OS+version+to+config%0D%0Atry+%7B%0D%0A++++%24osVersion+%3D+if+%28%5BSystem.Environment%5D%3A%3AOSVersion.Version.Build+-ge+22000%29+%7B+%2211%22+%7D+else+%7B+%2210%22+%7D%0D%0A++++%24configJson+%3D+%24configJson+-replace+%27%22WindowsVersion%22%3A%5Cs*%22__OSVERSION__%22%27%2C+%22%60%22WindowsVersion%60%22%3A+%60%22%24osVersion%60%22%22%0D%0A%7D+catch+%7B%0D%0A++++Write-Host+%22%5BWARNING%5D+Could+not+determine+OS+version%2C+defaulting+to+Windows+10%22%0D%0A++++%24configJson+%3D+%24configJson+-replace+%27%22WindowsVersion%22%3A%5Cs*%22__OSVERSION__%22%27%2C+%27%22WindowsVersion%22%3A+%2210%22%27%0D%0A%7D%0D%0A%0D%0A%23+Download%0D%0AWrite-LoggedOperation+%7B%0D%0A++++%24release+%3D+Invoke-RestMethod+%22https%3A%2F%2Fapi.github.com%2Frepos%2Fhellzerg%2Foptimizer%2Freleases%2Flatest%22+-Headers+%40%7B+%22User-Agent%22+%3D+%22PS%22+%7D%0D%0A++++%24exeUrl+%3D+%28%24release.assets+%7C+Where-Object+name+-like+%22*.exe%22%29.browser_download_url%0D%0A++++Invoke-WebRequest+-Uri+%24exeUrl+-OutFile+%22%24env%3ATEMP%5COptimizer.exe%22%0D%0A%7D+%22Downloading+Optimizer.exe%22%0D%0A%0D%0A%23+Execution%0D%0AWrite-LoggedOperation+%7B%0D%0A++++%23+Save+config+to+file%0D%0A++++%24configPath+%3D+%22%24env%3ATEMP%5Coptimizer_config.json%22%0D%0A++++%24configJson+%7C+Out-File+-FilePath+%24configPath+-Encoding+utf8+-Force%0D%0A%0D%0A++++%23+Run+Optimizer+with+config%0D%0A++++%24psi+%3D+New-Object+System.Diagnostics.ProcessStartInfo%0D%0A++++%24psi.FileName+%3D+%22%24env%3ATEMP%5COptimizer.exe%22%0D%0A++++%24psi.Arguments+%3D+%22%2Fconfig%3D%24configPath%22%0D%0A++++%24psi.RedirectStandardOutput+%3D+%24true%0D%0A++++%24psi.RedirectStandardError++%3D+%24true%0D%0A++++%24psi.UseShellExecute+%3D+%24false%0D%0A++++%24psi.CreateNoWindow+%3D+%24true%0D%0A%0D%0A++++%24proc+%3D+New-Object+System.Diagnostics.Process%0D%0A++++%24proc.StartInfo+%3D+%24psi%0D%0A++++%24null+%3D+%24proc.Start%28%29%0D%0A%0D%0A++++%24stdout+%3D+%24proc.StandardOutput%0D%0A++++%24stderr+%3D+%24proc.StandardError%0D%0A%0D%0A++++while+%28-not+%24proc.HasExited%29+%7B%0D%0A++++++++while+%28%21%24stdout.EndOfStream%29+%7B%0D%0A++++++++++++%24line+%3D+%24stdout.ReadLine%28%29%0D%0A++++++++++++if+%28%24line%29+%7B+Write-Host+%24line+%7D%0D%0A++++++++%7D%0D%0A++++++++Start-Sleep+-Milliseconds+100%0D%0A++++%7D%0D%0A%0D%0A++++while+%28%21%24stdout.EndOfStream%29+%7B%0D%0A++++++++%24line+%3D+%24stdout.ReadLine%28%29%0D%0A++++++++if+%28%24line%29+%7B+Write-Host+%24line+%7D%0D%0A++++%7D%0D%0A%0D%0A++++%24errors+%3D+%24stderr.ReadToEnd%28%29%0D%0A++++if+%28%24errors%29+%7B+Write-Host+%22%60n%3D%3D%3D+STDERR+%3D%3D%3D%60n%24errors%22+%7D%0D%0A%7D+%22Running+Optimizer+with+config%22%0D%0A%0D%0A%23+Cleanup%0D%0AWrite-LoggedOperation+%7B%0D%0A++++Remove-Item+%22%24env%3ATEMP%5COptimizer.exe%22+-Force+-ErrorAction+SilentlyContinue%0D%0A++++Remove-Item+%22%24env%3ATEMP%5Coptimizer_config.json%22+-Force+-ErrorAction+SilentlyContinue%0D%0A%7D+%22Cleaning+up+temporary+files%22%0D%0A%0D%0A%24runtime+%3D+%28Get-Date%29+-+%24start%0D%0AWrite-Host+%22%60nCompleted+in+%24%28%5Bmath%5D%3A%3ARound%28%24runtime.TotalSeconds%2C+2%29%29+seconds.%22%0D%0AStop-Transcript&FirstLogonScriptType4=Ps1&FirstLogonScript5=%23+Windows+Debloat+-+WindowsSpyBlocker+Automation+Script%0D%0A%23+Silently+installs+and+runs+the+latest+WindowsSpyBlocker+to+apply+telemetry+blocking+rules%0D%0A%0D%0A%24logDir+%3D+Join-Path+%24env%3ATEMP+%22WinDebloatLogs%22%0D%0Aif+%28-not+%28Test-Path+%24logDir%29%29+%7B+New-Item+-ItemType+Directory+-Path+%24logDir+-Force+%7C+Out-Null+%7D%0D%0A%24timestamp+%3D+Get-Date+-Format+%22yyyyMMdd_HHmmss%22%0D%0AStart-Transcript+-Path+%28Join-Path+%24logDir+%2206_WindowsSpyBlocker_%24timestamp.log%22%29+-Append+-Force%0D%0A%24start+%3D+Get-Date%0D%0A%0D%0Afunction+Write-LoggedOperation+%7B%0D%0A++++param+%28%5Bscriptblock%5D%24Block%2C+%5Bstring%5D%24Description%29%0D%0A++++Write-Host+%22%60n%5BINFO%5D+%24Description%22%0D%0A++++try+%7B+%26+%24Block%3B+Write-Host+%22%5BSUCCESS%5D+%24Description+completed%22+%7D+%0D%0A++++catch+%7B+Write-Host+%22%5BERROR%5D+%24Description+failed%3A+%24%28%24_.Exception.Message%29%22+%7D%0D%0A%7D%0D%0A%0D%0A%23+Download%0D%0AWrite-LoggedOperation+%7B%0D%0A++++%24release+%3D+Invoke-RestMethod+%22https%3A%2F%2Fapi.github.com%2Frepos%2Fcrazy-max%2FWindowsSpyBlocker%2Freleases%2Flatest%22+-Headers+%40%7B+%22User-Agent%22+%3D+%22PS%22+%7D%0D%0A++++%24exeUrl+%3D+%28%24release.assets+%7C+Where-Object+name+-like+%22*.exe%22%29.browser_download_url%0D%0A++++Invoke-WebRequest+-Uri+%24exeUrl+-OutFile+%22%24env%3ATEMP%5CWindowsSpyBlocker.exe%22%0D%0A%7D+%22Downloading+WindowsSpyBlocker.exe%22%0D%0A%0D%0A%23+Execution%0D%0AWrite-LoggedOperation+%7B%0D%0A++++%24psi+%3D+New-Object+System.Diagnostics.ProcessStartInfo%0D%0A++++%24psi.FileName+%3D+%22%24env%3ATEMP%5CWindowsSpyBlocker.exe%22%0D%0A++++%24psi.RedirectStandardInput++%3D+%24true%0D%0A++++%24psi.RedirectStandardOutput+%3D+%24true%0D%0A++++%24psi.RedirectStandardError++%3D+%24true%0D%0A++++%24psi.UseShellExecute+%3D+%24false%0D%0A++++%24psi.CreateNoWindow+%3D+%24true%0D%0A%0D%0A++++%24proc+%3D+New-Object+System.Diagnostics.Process%0D%0A++++%24proc.StartInfo+%3D+%24psi%0D%0A++++%24null+%3D+%24proc.Start%28%29%0D%0A%0D%0A++++%24stdin++%3D+%24proc.StandardInput%0D%0A++++%24stdout+%3D+%24proc.StandardOutput%0D%0A++++%24stderr+%3D+%24proc.StandardError%0D%0A%0D%0A++++%24stdin.WriteLine%28%221%22%29%0D%0A++++Start-Sleep+-Milliseconds+300%0D%0A++++%24stdin.WriteLine%28%221%22%29%0D%0A++++Start-Sleep+-Milliseconds+300%0D%0A++++%24stdin.WriteLine%28%221%22%29%0D%0A++++Start-Sleep+-Milliseconds+300%0D%0A++++%24stdin.WriteLine%28%22exit%22%29%0D%0A++++%24stdin.Close%28%29%0D%0A%0D%0A++++while+%28-not+%24proc.HasExited%29+%7B%0D%0A++++++++while+%28%21%24stdout.EndOfStream%29+%7B%0D%0A++++++++++++%24line+%3D+%24stdout.ReadLine%28%29%0D%0A++++++++++++if+%28%24line%29+%7B+Write-Host+%24line+%7D%0D%0A++++++++%7D%0D%0A++++++++Start-Sleep+-Milliseconds+100%0D%0A++++%7D%0D%0A%0D%0A++++while+%28%21%24stdout.EndOfStream%29+%7B%0D%0A++++++++%24line+%3D+%24stdout.ReadLine%28%29%0D%0A++++++++if+%28%24line%29+%7B+Write-Host+%24line+%7D%0D%0A++++%7D%0D%0A%0D%0A++++%24errors+%3D+%24stderr.ReadToEnd%28%29%0D%0A++++if+%28%24errors%29+%7B+Write-Host+%22%60n%3D%3D%3D+STDERR+%3D%3D%3D%60n%24errors%22+%7D%0D%0A%7D+%22Running+WindowsSpyBlocker+silently%22%0D%0A%0D%0A%23+Cleanup%0D%0AWrite-LoggedOperation+%7B%0D%0A++++%24pathsToDelete+%3D+%40%28%0D%0A++++++++%22%24env%3ATEMP%5Clibs%22%2C%0D%0A++++++++%22%24env%3ATEMP%5Clogs%22%2C%0D%0A++++++++%22%24env%3ATEMP%5Ctmp%22%2C%0D%0A++++++++%22%24env%3ATEMP%5Capp.conf%22%2C%0D%0A++++++++%22%24env%3ATEMP%5CWindowsSpyBlocker.exe%22%0D%0A++++%29%0D%0A++++foreach+%28%24path+in+%24pathsToDelete%29+%7B%0D%0A++++++++if+%28Test-Path+%24path%29+%7B%0D%0A++++++++++++Remove-Item+%24path+-Recurse+-Force+-ErrorAction+SilentlyContinue%0D%0A++++++++%7D%0D%0A++++%7D%0D%0A%7D+%22Cleaning+up+WindowsSpyBlocker+files%22%0D%0A%0D%0A%24runtime+%3D+%28Get-Date%29+-+%24start%0D%0AWrite-Host+%22%60nCompleted+in+%24%28%5Bmath%5D%3A%3ARound%28%24runtime.TotalSeconds%2C+2%29%29+seconds.%22%0D%0AStop-Transcript&FirstLogonScriptType5=Ps1&FirstLogonScript6=%23+Windows+Debloat+-+Winget+Application+Installation+Script%0D%0A%23+Installs+Winget+if+not+present+and+installs+a+set+of+applications%0D%0A%0D%0A%24logDir+%3D+Join-Path+%24env%3ATEMP+%22WinDebloatLogs%22%0D%0Aif+%28-not+%28Test-Path+%24logDir%29%29+%7B+New-Item+-ItemType+Directory+-Path+%24logDir+-Force+%7C+Out-Null+%7D%0D%0A%24timestamp+%3D+Get-Date+-Format+%22yyyyMMdd_HHmmss%22%0D%0AStart-Transcript+-Path+%28Join-Path+%24logDir+%2203_Winget_Apps_%24timestamp.log%22%29+-Append+-Force%0D%0A%24start+%3D+Get-Date%0D%0A%0D%0A%23+Configuration%0D%0A%24RemoveShortcuts+%3D+%24true%0D%0A%24appList+%3D+%40%28%0D%0A++++%22EpicGames.EpicGamesLauncher%22%0D%0A++++%22Valve.Steam%22%0D%0A++++%22Discord.Discord%22%0D%0A++++%22Spotify.Spotify%22%0D%0A++++%22Zen-Team.Zen-Browser%22%0D%0A++++%22Microsoft.WindowsTerminal%22%0D%0A++++%22voidtools.Everything%22%0D%0A%29%0D%0A%24shortcutFragments+%3D+%24appList+%7C+ForEach-Object+%7B+%28%24_+-split+%27%5C.%27%29%5B1%5D+%7D+%7C+Where-Object+%7B+%24_+%7D%0D%0A%0D%0Afunction+Write-LoggedOperation+%7B%0D%0A++++param+%28%0D%0A++++++++%5Bscriptblock%5D%24Block%2C%0D%0A++++++++%5Bstring%5D%24Description%0D%0A++++%29%0D%0A++++Write-Host+%22%60n%5BINFO%5D+%24Description%22%0D%0A++++try+%7B+%26+%24Block%3B+Write-Host+%22%5BSUCCESS%5D+%24Description+completed%22+%7D+%0D%0A++++catch+%7B+Write-Host+%22%5BERROR%5D+%24Description+failed%3A+%24%28%24_.Exception.Message%29%22+%7D%0D%0A%7D%0D%0A%0D%0Afunction+Remove-Shortcut+%7B%0D%0A++++param+%28%0D%0A++++++++%5BParameter%28Mandatory+%3D+%24true%29%5D%0D%0A++++++++%5Bstring%5B%5D%5D%24NameFragments%0D%0A++++%29%0D%0A%0D%0A++++%24shortcutPaths+%3D+%40%28%0D%0A++++++++%22%24env%3AUSERPROFILE%5CDesktop%22%2C%0D%0A++++++++%22C%3A%5CUsers%5CPublic%5CDesktop%22%0D%0A++++%29%0D%0A%0D%0A++++foreach+%28%24path+in+%24shortcutPaths%29+%7B%0D%0A++++++++foreach+%28%24fragment+in+%24NameFragments%29+%7B%0D%0A++++++++++++Get-ChildItem+-Path+%24path+-Filter+*.lnk+-ErrorAction+SilentlyContinue+%7C%0D%0A++++++++++++++++Where-Object+%7B+%24_.Name+-match+%5Bregex%5D%3A%3AEscape%28%24fragment%29+%7D+%7C%0D%0A++++++++++++++++ForEach-Object+%7B%0D%0A++++++++++++++++++++Write-Host+%22%60n%5BINFO%5D+Found+shortcut+matching+%27%24fragment%27%3A+%24%28%24_.FullName%29%22%0D%0A++++++++++++++++++++Write-LoggedOperation+%7B%0D%0A++++++++++++++++++++++++Remove-Item+%24_.FullName+-Force+-ErrorAction+SilentlyContinue%0D%0A++++++++++++++++++++%7D+%22Removing+shortcut%3A+%24%28%24_.Name%29%22%0D%0A++++++++++++++++%7D%0D%0A++++++++%7D%0D%0A++++%7D%0D%0A%7D%0D%0A%0D%0A%23+Path+setup%0D%0A%24VCLibs+++++++%3D+%22%24env%3ATEMP%5CMicrosoft.VCLibs.x64.14.00.Desktop.appx%22%0D%0A%24UIXaml+++++++%3D+%22%24env%3ATEMP%5CMicrosoft.UI.Xaml.2.8.x64.appx%22%0D%0A%24winget+++++++%3D+%22%24env%3ATEMP%5Cwinget.msixbundle%22%0D%0A%0D%0A%24VCLibsUrl++++%3D+%22https%3A%2F%2Faka.ms%2FMicrosoft.VCLibs.x64.14.00.Desktop.appx%22%0D%0A%24UIXamlUrl++++%3D+%22https%3A%2F%2Fgithub.com%2Fmicrosoft%2Fmicrosoft-ui-xaml%2Freleases%2Fdownload%2Fv2.8.6%2FMicrosoft.UI.Xaml.2.8.x64.appx%22%0D%0A%24wingetUrl++++%3D+%22https%3A%2F%2Fapi.github.com%2Frepos%2Fmicrosoft%2Fwinget-cli%2Freleases%2Flatest%22%0D%0A%0D%0A%23+Dependencies%0D%0AWrite-LoggedOperation+%7B%0D%0A++++%26+curl.exe+-L+-o+%24VCLibs+%24VCLibsUrl%0D%0A++++Add-AppxPackage+-Path+%24VCLibs%0D%0A%7D+%22Installing+Microsoft.VCLibs+%28UWP+C%2B%2B+runtime%29%22%0D%0A%0D%0AWrite-LoggedOperation+%7B%0D%0A++++%26+curl.exe+-L+-o+%24UIXaml+%24UIXamlUrl%0D%0A++++Add-AppxPackage+-Path+%24UIXaml%0D%0A%7D+%22Installing+Microsoft.UI.Xaml+%28UI+framework%29%22%0D%0A%0D%0A%23+Winget+installation%0D%0AWrite-LoggedOperation+%7B%0D%0A++++%5BNet.ServicePointManager%5D%3A%3ASecurityProtocol+%3D+%5BNet.SecurityProtocolType%5D%3A%3ATls12%0D%0A++++%24bundle+%3D+%28Invoke-RestMethod+%24wingetUrl%29.assets+%7C+Where-Object+%7B+%24_.name+-like+%22*.msixbundle%22+%7D+%7C+Select-Object+-First+1%0D%0A++++%26+curl.exe+-L+-J+-o+%24winget+%24bundle.browser_download_url%0D%0A++++if+%28-Not+%28Test-Path+%24winget%29%29+%7B+throw+%22Download+failed%3A+%24winget+was+not+created.%22+%7D%0D%0A++++Add-AppxPackage+-Path+%24winget%0D%0A%7D+%22Installing+winget+%28Windows+Package+Manager%29%22%0D%0A%0D%0A%23+Winget+verification%0D%0ASet-Variable+-Name+wingetAvailable+-Value+%24false+-Scope+Script%0D%0AWrite-LoggedOperation+%7B%0D%0A++++winget+%2D%2Dversion+%7C+Out-Null%0D%0A++++%24script%3AwingetAvailable+%3D+%24true%0D%0A%7D+%22Verifying+winget+is+available%22%0D%0A%0D%0A%23+Application+installation%0D%0Aif+%28%24wingetAvailable%29+%7B%0D%0A++++Write-LoggedOperation+%7B%0D%0A++++++++Remove-Item+-LiteralPath+%24winget+-Force+-ErrorAction+SilentlyContinue%0D%0A++++++++Remove-Item+-LiteralPath+%24UIXaml+-Force+-ErrorAction+SilentlyContinue%0D%0A++++++++Remove-Item+-LiteralPath+%24VCLibs+-Force+-ErrorAction+SilentlyContinue%0D%0A++++%7D+%22Cleaning+up+temporary+files%22%0D%0A%0D%0A++++%23+Install+applications%0D%0A++++foreach+%28%24app+in+%24appList%29+%7B%0D%0A++++++++Write-LoggedOperation+%7B%0D%0A++++++++++++winget+install+%2D%2Did%3D%24app+-e+%2D%2Daccept-source-agreements+%2D%2Daccept-package-agreements%0D%0A++++++++%7D+%22Installing+%24app%22%0D%0A++++%7D%0D%0A%0D%0A++++%23+Optional+shortcut+cleanup%0D%0A++++if+%28%24RemoveShortcuts%29+%7B%0D%0A++++++++Write-LoggedOperation+%7B%0D%0A++++++++++++Remove-Shortcut+-NameFragments+%24shortcutFragments%0D%0A++++++++%7D+%22Removing+desktop+shortcuts+for+installed+apps%22%0D%0A++++%7D%0D%0A%7D+else+%7B%0D%0A++++Write-Host+%22%60n%5BWARNING%5D+winget+is+not+available.+Skipping+app+installations+and+cleanup.%22%0D%0A%7D%0D%0A%0D%0A%24runtime+%3D+%28Get-Date%29+-+%24start%0D%0AWrite-Host+%22%60nCompleted+in+%24%28%5Bmath%5D%3A%3ARound%28%24runtime.TotalSeconds%2C+2%29%29+seconds.%22%0D%0AStop-Transcript&FirstLogonScriptType6=Ps1&RestartExplorer=true&WdacMode=Skip-->
	<settings pass="offlineServicing"></settings>
	<settings pass="windowsPE">
		<component name="Microsoft-Windows-International-Core-WinPE" processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS">
			<SetupUILanguage>
				<UILanguage>en-US</UILanguage>
			</SetupUILanguage>
			<InputLocale>1009:00011009</InputLocale>
			<SystemLocale>en-CA</SystemLocale>
			<UILanguage>en-US</UILanguage>
			<UserLocale>en-CA</UserLocale>
		</component>
		<component name="Microsoft-Windows-Setup" processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS">
			<ImageInstall>
				<OSImage>
					<InstallTo>
						<DiskID>0</DiskID>
						<PartitionID>3</PartitionID>
					</InstallTo>
				</OSImage>
			</ImageInstall>
			<UserData>
				<ProductKey>
					<Key>VK7JG-NPHTM-C97JM-9MPGT-3V66T</Key>
					<WillShowUI>OnError</WillShowUI>
				</ProductKey>
				<AcceptEula>true</AcceptEula>
			</UserData>
			<UseConfigurationSet>true</UseConfigurationSet>
			<RunSynchronous>
				<RunSynchronousCommand wcm:action="add">
					<Order>1</Order>
					<Path>cmd.exe /c "&gt;&gt;"X:\assert.vbs" (echo On Error Resume Next&amp;echo Set wmi = GetObject("winmgmts:\\.\root\cimv2"^)&amp;echo Set drive = wmi.Get("Win32_DiskDrive.DeviceID='\\.\PHYSICALDRIVE0'"^)&amp;echo If Err.Number ^&lt;^&gt; 0 Then)"</Path>
				</RunSynchronousCommand>
				<RunSynchronousCommand wcm:action="add">
					<Order>2</Order>
					<Path>cmd.exe /c "&gt;&gt;"X:\assert.vbs" (echo Msgbox Err.Description&amp;echo WScript.Quit 1&amp;echo End If&amp;echo If drive.InterfaceType = "IDE" Or drive.InterfaceType = "SCSI" Then&amp;echo WScript.Quit 0&amp;echo Else)"</Path>
				</RunSynchronousCommand>
				<RunSynchronousCommand wcm:action="add">
					<Order>3</Order>
					<Path>cmd.exe /c "&gt;&gt;"X:\assert.vbs" (echo MsgBox "Assertion failed."&amp;echo WScript.Quit 1&amp;echo End If)"</Path>
				</RunSynchronousCommand>
				<RunSynchronousCommand wcm:action="add">
					<Order>4</Order>
					<Path>cscript.exe //E:vbscript "X:\assert.vbs"</Path>
				</RunSynchronousCommand>
				<RunSynchronousCommand wcm:action="add">
					<Order>5</Order>
					<Path>cmd.exe /c "&gt;&gt;"X:\diskpart.txt" (echo SELECT DISK=0&amp;echo CLEAN&amp;echo CONVERT GPT&amp;echo CREATE PARTITION EFI SIZE=300&amp;echo FORMAT QUICK FS=FAT32 LABEL="System"&amp;echo CREATE PARTITION MSR SIZE=16)"</Path>
				</RunSynchronousCommand>
				<RunSynchronousCommand wcm:action="add">
					<Order>6</Order>
					<Path>cmd.exe /c "&gt;&gt;"X:\diskpart.txt" (echo CREATE PARTITION PRIMARY&amp;echo SHRINK MINIMUM=1000&amp;echo FORMAT QUICK FS=NTFS LABEL="Windows"&amp;echo CREATE PARTITION PRIMARY&amp;echo FORMAT QUICK FS=NTFS LABEL="Recovery")"</Path>
				</RunSynchronousCommand>
				<RunSynchronousCommand wcm:action="add">
					<Order>7</Order>
					<Path>cmd.exe /c "&gt;&gt;"X:\diskpart.txt" (echo SET ID="de94bba4-06d1-4d40-a16a-bfd50179d6ac"&amp;echo GPT ATTRIBUTES=0x8000000000000001)"</Path>
				</RunSynchronousCommand>
				<RunSynchronousCommand wcm:action="add">
					<Order>8</Order>
					<Path>cmd.exe /c "diskpart.exe /s "X:\diskpart.txt" &gt;&gt;"X:\diskpart.log" || ( type "X:\diskpart.log" &amp; echo diskpart encountered an error. &amp; pause &amp; exit /b 1 )"</Path>
				</RunSynchronousCommand>
				<RunSynchronousCommand wcm:action="add">
					<Order>9</Order>
					<Path>reg.exe add "HKLM\SYSTEM\Setup\LabConfig" /v BypassTPMCheck /t REG_DWORD /d 1 /f</Path>
				</RunSynchronousCommand>
				<RunSynchronousCommand wcm:action="add">
					<Order>10</Order>
					<Path>reg.exe add "HKLM\SYSTEM\Setup\LabConfig" /v BypassSecureBootCheck /t REG_DWORD /d 1 /f</Path>
				</RunSynchronousCommand>
				<RunSynchronousCommand wcm:action="add">
					<Order>11</Order>
					<Path>reg.exe add "HKLM\SYSTEM\Setup\LabConfig" /v BypassRAMCheck /t REG_DWORD /d 1 /f</Path>
				</RunSynchronousCommand>
			</RunSynchronous>
		</component>
	</settings>
	<settings pass="generalize"></settings>
	<settings pass="specialize">
		<component name="Microsoft-Windows-Shell-Setup" processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS">
			<ComputerName>TEMPNAME</ComputerName>
		</component>
		<component name="Microsoft-Windows-Deployment" processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS">
			<RunSynchronous>
				<RunSynchronousCommand wcm:action="add">
					<Order>1</Order>
					<Path>powershell.exe -WindowStyle Hidden -NoProfile -Command "$xml = [xml]::new(); $xml.Load('C:\Windows\Panther\unattend.xml'); $sb = [scriptblock]::Create( $xml.unattend.Extensions.ExtractScript ); Invoke-Command -ScriptBlock $sb -ArgumentList $xml;"</Path>
				</RunSynchronousCommand>
				<RunSynchronousCommand wcm:action="add">
					<Order>2</Order>
					<Path>powershell.exe -WindowStyle Hidden -NoProfile -Command "Get-Content -LiteralPath 'C:\Windows\Setup\Scripts\Specialize.ps1' -Raw | Invoke-Expression;"</Path>
				</RunSynchronousCommand>
				<RunSynchronousCommand wcm:action="add">
					<Order>3</Order>
					<Path>reg.exe load "HKU\DefaultUser" "C:\Users\Default\NTUSER.DAT"</Path>
				</RunSynchronousCommand>
				<RunSynchronousCommand wcm:action="add">
					<Order>4</Order>
					<Path>powershell.exe -WindowStyle Hidden -NoProfile -Command "Get-Content -LiteralPath 'C:\Windows\Setup\Scripts\DefaultUser.ps1' -Raw | Invoke-Expression;"</Path>
				</RunSynchronousCommand>
				<RunSynchronousCommand wcm:action="add">
					<Order>5</Order>
					<Path>reg.exe unload "HKU\DefaultUser"</Path>
				</RunSynchronousCommand>
			</RunSynchronous>
		</component>
	</settings>
	<settings pass="auditSystem"></settings>
	<settings pass="auditUser"></settings>
	<settings pass="oobeSystem">
		<component name="Microsoft-Windows-International-Core" processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS">
			<InputLocale>1009:00011009</InputLocale>
			<SystemLocale>en-CA</SystemLocale>
			<UILanguage>en-US</UILanguage>
			<UserLocale>en-CA</UserLocale>
		</component>
		<component name="Microsoft-Windows-Shell-Setup" processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS">
			<UserAccounts>
				<LocalAccounts>
					<LocalAccount wcm:action="add">
						<Name>user</Name>
						<DisplayName></DisplayName>
						<Group>Administrators</Group>
						<Password>
							<Value>root</Value>
							<PlainText>true</PlainText>
						</Password>
					</LocalAccount>
				</LocalAccounts>
			</UserAccounts>
			<AutoLogon>
				<Username>user</Username>
				<Enabled>true</Enabled>
				<LogonCount>1</LogonCount>
				<Password>
					<Value>root</Value>
					<PlainText>true</PlainText>
				</Password>
			</AutoLogon>
			<OOBE>
				<ProtectYourPC>3</ProtectYourPC>
				<HideEULAPage>true</HideEULAPage>
				<HideWirelessSetupInOOBE>true</HideWirelessSetupInOOBE>
				<HideOnlineAccountScreens>false</HideOnlineAccountScreens>
			</OOBE>
			<FirstLogonCommands>
				<SynchronousCommand wcm:action="add">
					<Order>1</Order>
					<CommandLine>powershell.exe -WindowStyle Hidden -NoProfile -Command "Get-Content -LiteralPath 'C:\Windows\Setup\Scripts\FirstLogon.ps1' -Raw | Invoke-Expression;"</CommandLine>
				</SynchronousCommand>
			</FirstLogonCommands>
		</component>
	</settings>
	<Extensions xmlns="https://schneegans.de/windows/unattend-generator/">
		<ExtractScript>
param(
    [xml] $Document
);

foreach( $file in $Document.unattend.Extensions.File ) {
    $path = [System.Environment]::ExpandEnvironmentVariables( $file.GetAttribute( 'path' ) );
    mkdir -Path( $path | Split-Path -Parent ) -ErrorAction 'SilentlyContinue';
    $encoding = switch( [System.IO.Path]::GetExtension( $path ) ) {
        { $_ -in '.ps1', '.xml' } { [System.Text.Encoding]::UTF8; }
        { $_ -in '.reg', '.vbs', '.js' } { [System.Text.UnicodeEncoding]::new( $false, $true ); }
        default { [System.Text.Encoding]::Default; }
    };
    $bytes = $encoding.GetPreamble() + $encoding.GetBytes( $file.InnerText.Trim() );
    [System.IO.File]::WriteAllBytes( $path, $bytes );
}
		</ExtractScript>
		<File path="C:\Windows\Setup\Scripts\GetComputerName.ps1">
# Generate a computer name in the format: WIN[10/11/XX]-[3 random alphanumeric characters]
# Example: WIN10-4F6, WIN11-XZ2

$osVersion = (Get-CimInstance Win32_OperatingSystem).Version.Split('.')[0]
$randomSuffix = -join ((65..90 + 48..57) | Get-Random -Count 3 | ForEach-Object { [char]$_ })
return "WIN$osVersion-$randomSuffix"

&lt;#
 CURRENTLY DISABLED DUE TO LONG DELAYS DURING WINDOWS INSTALLATION
# Generates a computer name like:
# WIN10-ABC, WIN11-XYZ, WINSRV19-Q7P, WINSRV25-T6L

# Get the OS product name (e.g., "Windows Server 2022 Standard")
$productName = (Get-ItemProperty 'HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion').ProductName

# Initialize prefix
$prefix = "WIN??"

# Try to extract 4-digit year if present (e.g., 2019, 2022, 2025)
if ($productName -like "*Server*") {
    if ($productName -match "20\d{2}") {
        $year = $Matches[0]
        $prefix = "WINSRV$($year.Substring(2))"  # use last two digits (e.g., "22")
    } else {
        $prefix = "WINSRV"
    }
}
elseif ($productName -match "Windows (\d+)") {
    $prefix = "WIN$($Matches[1])"
}

# Generate random 3-character alphanumeric suffix (A&#x2013;Z, 0&#x2013;9)
$random = -join ((65..90 + 48..57) | Get-Random -Count 3 | ForEach-Object { [char]$_ })

# Return computer name
return "$prefix-$random"

#&gt;
		</File>
		<File path="C:\Windows\Setup\Scripts\SetComputerName.ps1">
$ErrorActionPreference = 'Stop';
Set-StrictMode -Version 'Latest';
&amp; {
	$newName = ( Get-Content -LiteralPath 'C:\Windows\Setup\Scripts\ComputerName.txt' -Raw ).Trim();
	if( [string]::IsNullOrWhitespace( $newName ) ) {
		throw "No computer name was provided.";
	}

	$keys = @(
		@{
			LiteralPath = 'Registry::HKLM\SYSTEM\CurrentControlSet\Control\ComputerName\ComputerName';
			Name = 'ComputerName';
		};
		@{
			LiteralPath = 'Registry::HKLM\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters';
			Name = 'Hostname';
		};
		@{
			LiteralPath = 'Registry::HKLM\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters';
			Name = 'NV Hostname';
		};
	);

	while( $true ) {
		foreach( $key in $keys ) {
			Set-ItemProperty @key -Type 'String' -Value $newName;
		}
		Start-Sleep -Milliseconds 50;
	}
} *&gt;&amp;1 &gt;&gt; 'C:\Windows\Setup\Scripts\SetComputerName.log';
		</File>
		<File path="C:\Windows\Setup\Scripts\RemovePackages.ps1">
$selectors = @(
	'Microsoft.Microsoft3DViewer';
	'Microsoft.BingSearch';
	'Microsoft.WindowsCalculator';
	'Microsoft.WindowsCamera';
	'Clipchamp.Clipchamp';
	'Microsoft.WindowsAlarms';
	'Microsoft.549981C3F5F10';
	'Microsoft.Windows.DevHome';
	'MicrosoftCorporationII.MicrosoftFamily';
	'Microsoft.WindowsFeedbackHub';
	'Microsoft.GetHelp';
	'Microsoft.Getstarted';
	'microsoft.windowscommunicationsapps';
	'Microsoft.WindowsMaps';
	'Microsoft.MixedReality.Portal';
	'Microsoft.BingNews';
	'Microsoft.WindowsNotepad';
	'Microsoft.MicrosoftOfficeHub';
	'Microsoft.Office.OneNote';
	'Microsoft.OutlookForWindows';
	'Microsoft.Paint';
	'Microsoft.MSPaint';
	'Microsoft.People';
	'Microsoft.Windows.Photos';
	'Microsoft.PowerAutomateDesktop';
	'MicrosoftCorporationII.QuickAssist';
	'Microsoft.SkypeApp';
	'Microsoft.MicrosoftSolitaireCollection';
	'Microsoft.MicrosoftStickyNotes';
	'MicrosoftTeams';
	'MSTeams';
	'Microsoft.Todos';
	'Microsoft.WindowsSoundRecorder';
	'Microsoft.Wallet';
	'Microsoft.BingWeather';
	'Microsoft.Xbox.TCUI';
	'Microsoft.XboxApp';
	'Microsoft.XboxGameOverlay';
	'Microsoft.XboxGamingOverlay';
	'Microsoft.XboxIdentityProvider';
	'Microsoft.XboxSpeechToTextOverlay';
	'Microsoft.GamingApp';
	'Microsoft.YourPhone';
	'Microsoft.ZuneMusic';
	'Microsoft.ZuneVideo';
);
$getCommand = {
  Get-AppxProvisionedPackage -Online;
};
$filterCommand = {
  $_.DisplayName -eq $selector;
};
$removeCommand = {
  [CmdletBinding()]
  param(
    [Parameter( Mandatory, ValueFromPipeline )]
    $InputObject
  );
  process {
    $InputObject | Remove-AppxProvisionedPackage -AllUsers -Online -ErrorAction 'Continue';
  }
};
$type = 'Package';
$logfile = 'C:\Windows\Setup\Scripts\RemovePackages.log';
&amp; {
	$installed = &amp; $getCommand;
	foreach( $selector in $selectors ) {
		$result = [ordered] @{
			Selector = $selector;
		};
		$found = $installed | Where-Object -FilterScript $filterCommand;
		if( $found ) {
			$result.Output = $found | &amp; $removeCommand;
			if( $? ) {
				$result.Message = "$type removed.";
			} else {
				$result.Message = "$type not removed.";
				$result.Error = $Error[0];
			}
		} else {
			$result.Message = "$type not installed.";
		}
		$result | ConvertTo-Json -Depth 3 -Compress;
	}
} *&gt;&amp;1 &gt;&gt; $logfile;
		</File>
		<File path="C:\Windows\Setup\Scripts\RemoveCapabilities.ps1">
$selectors = @(
	'Print.Fax.Scan';
	'Language.Handwriting';
	'Browser.InternetExplorer';
	'MathRecognizer';
	'OneCoreUAP.OneSync';
	'OpenSSH.Client';
	'Microsoft.Windows.MSPaint';
	'App.Support.QuickAssist';
	'Language.Speech';
	'Language.TextToSpeech';
	'App.StepsRecorder';
	'Hello.Face.18967';
	'Hello.Face.Migration.18967';
	'Hello.Face.20134';
	'Media.WindowsMediaPlayer';
	'Microsoft.Windows.WordPad';
);
$getCommand = {
  Get-WindowsCapability -Online | Where-Object -Property 'State' -NotIn -Value @(
    'NotPresent';
    'Removed';
  );
};
$filterCommand = {
  ($_.Name -split '~')[0] -eq $selector;
};
$removeCommand = {
  [CmdletBinding()]
  param(
    [Parameter( Mandatory, ValueFromPipeline )]
    $InputObject
  );
  process {
    $InputObject | Remove-WindowsCapability -Online -ErrorAction 'Continue';
  }
};
$type = 'Capability';
$logfile = 'C:\Windows\Setup\Scripts\RemoveCapabilities.log';
&amp; {
	$installed = &amp; $getCommand;
	foreach( $selector in $selectors ) {
		$result = [ordered] @{
			Selector = $selector;
		};
		$found = $installed | Where-Object -FilterScript $filterCommand;
		if( $found ) {
			$result.Output = $found | &amp; $removeCommand;
			if( $? ) {
				$result.Message = "$type removed.";
			} else {
				$result.Message = "$type not removed.";
				$result.Error = $Error[0];
			}
		} else {
			$result.Message = "$type not installed.";
		}
		$result | ConvertTo-Json -Depth 3 -Compress;
	}
} *&gt;&amp;1 &gt;&gt; $logfile;
		</File>
		<File path="C:\Windows\Setup\Scripts\RemoveFeatures.ps1">
$selectors = @(
	'MediaPlayback';
	'MicrosoftWindowsPowerShellV2Root';
	'Microsoft-RemoteDesktopConnection';
	'Recall';
);
$getCommand = {
  Get-WindowsOptionalFeature -Online | Where-Object -Property 'State' -NotIn -Value @(
    'Disabled';
    'DisabledWithPayloadRemoved';
  );
};
$filterCommand = {
  $_.FeatureName -eq $selector;
};
$removeCommand = {
  [CmdletBinding()]
  param(
    [Parameter( Mandatory, ValueFromPipeline )]
    $InputObject
  );
  process {
    $InputObject | Disable-WindowsOptionalFeature -Online -Remove -NoRestart -ErrorAction 'Continue';
  }
};
$type = 'Feature';
$logfile = 'C:\Windows\Setup\Scripts\RemoveFeatures.log';
&amp; {
	$installed = &amp; $getCommand;
	foreach( $selector in $selectors ) {
		$result = [ordered] @{
			Selector = $selector;
		};
		$found = $installed | Where-Object -FilterScript $filterCommand;
		if( $found ) {
			$result.Output = $found | &amp; $removeCommand;
			if( $? ) {
				$result.Message = "$type removed.";
			} else {
				$result.Message = "$type not removed.";
				$result.Error = $Error[0];
			}
		} else {
			$result.Message = "$type not installed.";
		}
		$result | ConvertTo-Json -Depth 3 -Compress;
	}
} *&gt;&amp;1 &gt;&gt; $logfile;
		</File>
		<File path="C:\Windows\Setup\Scripts\PauseWindowsUpdate.ps1">
$formatter = {
	$args[0].ToString( "yyyy'-'MM'-'dd'T'HH':'mm':'ssK" );
};
$now = [datetime]::UtcNow;
$start = &amp; $formatter $now;
$end = &amp; $formatter $now.AddDays( 7 );

$params = @{
	LiteralPath = 'Registry::HKLM\SOFTWARE\Microsoft\WindowsUpdate\UX\Settings';
	Type = 'String';
	Force = $true;
};

Set-ItemProperty @params -Name 'PauseFeatureUpdatesStartTime' -Value $start;
Set-ItemProperty @params -Name 'PauseFeatureUpdatesEndTime' -Value $end;
Set-ItemProperty @params -Name 'PauseQualityUpdatesStartTime' -Value $start;
Set-ItemProperty @params -Name 'PauseQualityUpdatesEndTime' -Value $end;
Set-ItemProperty @params -Name 'PauseUpdatesStartTime' -Value $start;
Set-ItemProperty @params -Name 'PauseUpdatesExpiryTime' -Value $end;
		</File>
		<File path="C:\Windows\Setup\Scripts\PauseWindowsUpdate.xml">
&lt;Task version="1.2" xmlns="http://schemas.microsoft.com/windows/2004/02/mit/task"&gt;
	&lt;Triggers&gt;
		&lt;BootTrigger&gt;
			&lt;Repetition&gt;
				&lt;Interval&gt;P1D&lt;/Interval&gt;
				&lt;StopAtDurationEnd&gt;false&lt;/StopAtDurationEnd&gt;
			&lt;/Repetition&gt;
			&lt;Enabled&gt;true&lt;/Enabled&gt;
		&lt;/BootTrigger&gt;
	&lt;/Triggers&gt;
	&lt;Principals&gt;
		&lt;Principal id="Author"&gt;
			&lt;UserId&gt;S-1-5-19&lt;/UserId&gt;
			&lt;RunLevel&gt;LeastPrivilege&lt;/RunLevel&gt;
		&lt;/Principal&gt;
	&lt;/Principals&gt;
	&lt;Settings&gt;
		&lt;MultipleInstancesPolicy&gt;IgnoreNew&lt;/MultipleInstancesPolicy&gt;
		&lt;DisallowStartIfOnBatteries&gt;false&lt;/DisallowStartIfOnBatteries&gt;
		&lt;StopIfGoingOnBatteries&gt;false&lt;/StopIfGoingOnBatteries&gt;
		&lt;AllowHardTerminate&gt;true&lt;/AllowHardTerminate&gt;
		&lt;StartWhenAvailable&gt;false&lt;/StartWhenAvailable&gt;
		&lt;RunOnlyIfNetworkAvailable&gt;false&lt;/RunOnlyIfNetworkAvailable&gt;
		&lt;IdleSettings&gt;
			&lt;StopOnIdleEnd&gt;true&lt;/StopOnIdleEnd&gt;
			&lt;RestartOnIdle&gt;false&lt;/RestartOnIdle&gt;
		&lt;/IdleSettings&gt;
		&lt;AllowStartOnDemand&gt;true&lt;/AllowStartOnDemand&gt;
		&lt;Enabled&gt;true&lt;/Enabled&gt;
		&lt;Hidden&gt;false&lt;/Hidden&gt;
		&lt;RunOnlyIfIdle&gt;false&lt;/RunOnlyIfIdle&gt;
		&lt;WakeToRun&gt;false&lt;/WakeToRun&gt;
		&lt;ExecutionTimeLimit&gt;PT72H&lt;/ExecutionTimeLimit&gt;
		&lt;Priority&gt;7&lt;/Priority&gt;
	&lt;/Settings&gt;
	&lt;Actions Context="Author"&gt;
		&lt;Exec&gt;
			&lt;Command&gt;C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe&lt;/Command&gt;
			&lt;Arguments&gt;-Command "Get-Content -LiteralPath 'C:\Windows\Setup\Scripts\PauseWindowsUpdate.ps1' -Raw | Invoke-Expression;"&lt;/Arguments&gt;
		&lt;/Exec&gt;
	&lt;/Actions&gt;
&lt;/Task&gt;
		</File>
		<File path="C:\Windows\Setup\Scripts\MoveActiveHours.vbs">
HKLM = &amp;H80000002
key = "SOFTWARE\Microsoft\WindowsUpdate\UX\Settings"
Set reg = GetObject("winmgmts://./root/default:StdRegProv")
current = Hour(Now)
reg.SetDWORDValue HKLM, key, "ActiveHoursStart", ( current + 23 ) Mod 24
reg.SetDWORDValue HKLM, key, "ActiveHoursEnd", ( current + 11 ) Mod 24
reg.SetDWORDValue HKLM, key, "SmartActiveHoursState", 2
		</File>
		<File path="C:\Windows\Setup\Scripts\MoveActiveHours.xml">
&lt;Task version="1.2" xmlns="http://schemas.microsoft.com/windows/2004/02/mit/task"&gt;
	&lt;Triggers&gt;
		&lt;BootTrigger&gt;
			&lt;Repetition&gt;
				&lt;Interval&gt;PT4H&lt;/Interval&gt;
				&lt;StopAtDurationEnd&gt;false&lt;/StopAtDurationEnd&gt;
			&lt;/Repetition&gt;
			&lt;Enabled&gt;true&lt;/Enabled&gt;
		&lt;/BootTrigger&gt;
		&lt;RegistrationTrigger&gt;
			&lt;Repetition&gt;
				&lt;Interval&gt;PT4H&lt;/Interval&gt;
				&lt;StopAtDurationEnd&gt;false&lt;/StopAtDurationEnd&gt;
			&lt;/Repetition&gt;
			&lt;Enabled&gt;true&lt;/Enabled&gt;
		&lt;/RegistrationTrigger&gt;
	&lt;/Triggers&gt;
	&lt;Principals&gt;
		&lt;Principal id="Author"&gt;
			&lt;UserId&gt;S-1-5-19&lt;/UserId&gt;
			&lt;RunLevel&gt;LeastPrivilege&lt;/RunLevel&gt;
		&lt;/Principal&gt;
	&lt;/Principals&gt;
	&lt;Settings&gt;
		&lt;MultipleInstancesPolicy&gt;IgnoreNew&lt;/MultipleInstancesPolicy&gt;
		&lt;DisallowStartIfOnBatteries&gt;false&lt;/DisallowStartIfOnBatteries&gt;
		&lt;StopIfGoingOnBatteries&gt;false&lt;/StopIfGoingOnBatteries&gt;
		&lt;AllowHardTerminate&gt;true&lt;/AllowHardTerminate&gt;
		&lt;StartWhenAvailable&gt;false&lt;/StartWhenAvailable&gt;
		&lt;RunOnlyIfNetworkAvailable&gt;false&lt;/RunOnlyIfNetworkAvailable&gt;
		&lt;IdleSettings&gt;
			&lt;StopOnIdleEnd&gt;true&lt;/StopOnIdleEnd&gt;
			&lt;RestartOnIdle&gt;false&lt;/RestartOnIdle&gt;
		&lt;/IdleSettings&gt;
		&lt;AllowStartOnDemand&gt;true&lt;/AllowStartOnDemand&gt;
		&lt;Enabled&gt;true&lt;/Enabled&gt;
		&lt;Hidden&gt;false&lt;/Hidden&gt;
		&lt;RunOnlyIfIdle&gt;false&lt;/RunOnlyIfIdle&gt;
		&lt;WakeToRun&gt;false&lt;/WakeToRun&gt;
		&lt;ExecutionTimeLimit&gt;PT72H&lt;/ExecutionTimeLimit&gt;
		&lt;Priority&gt;7&lt;/Priority&gt;
	&lt;/Settings&gt;
	&lt;Actions Context="Author"&gt;
		&lt;Exec&gt;
			&lt;Command&gt;C:\Windows\System32\wscript.exe&lt;/Command&gt;
			&lt;Arguments&gt;C:\Windows\Setup\Scripts\MoveActiveHours.vbs&lt;/Arguments&gt;
		&lt;/Exec&gt;
	&lt;/Actions&gt;
&lt;/Task&gt;
		</File>
		<File path="C:\Windows\Setup\Scripts\VMwareTools.ps1">
&amp; {
	foreach( $letter in 'DEFGHIJKLMNOPQRSTUVWXYZ'.ToCharArray() ) {
		$exe = "${letter}:\setup.exe";
		if( ( Get-Item -LiteralPath $exe -ErrorAction 'SilentlyContinue' | Select-Object -ExpandProperty 'VersionInfo' | Select-Object -ExpandProperty 'ProductName' ) -eq 'VMware Tools' ) {
			Start-Process -FilePath $exe -ArgumentList '/s /v /qn REBOOT=R' -Wait;
			return;
		}
	}
	'VMware Tools image (windows.iso) is not attached to this VM.';
} *&gt;&amp;1 &gt;&gt; "C:\Windows\Setup\Scripts\VMwareTools.log";
		</File>
		<File path="C:\Windows\Setup\Scripts\VirtIoGuestTools.ps1">
&amp; {
	foreach( $letter in 'DEFGHIJKLMNOPQRSTUVWXYZ'.ToCharArray() ) {
		$exe = "${letter}:\virtio-win-guest-tools.exe";
		if( Test-Path -LiteralPath $exe ) {
			Start-Process -FilePath $exe -ArgumentList '/passive', '/norestart' -Wait;
			return;
		}
	}
	'VirtIO Guest Tools image (virtio-win-*.iso) is not attached to this VM.';
} *&gt;&amp;1 &gt;&gt; 'C:\Windows\Setup\Scripts\VirtIoGuestTools.log';
		</File>
		<File path="C:\Windows\Setup\Scripts\MakeEdgeUninstallable.ps1">
$ErrorActionPreference = 'Stop';
&amp; {
	try {
		$params = @{
			LiteralPath = 'C:\Windows\System32\IntegratedServicesRegionPolicySet.json';
			Encoding = 'Utf8';
		};
		$o = Get-Content @params | ConvertFrom-Json;
		$o.policies | ForEach-Object -Process {
			if( $_.guid -eq '{1bca278a-5d11-4acf-ad2f-f9ab6d7f93a6}' ) {
				$_.defaultState = 'enabled';
			}
		};
		$o | ConvertTo-Json -Depth 9 | Out-File @params;
	} catch {
		$_;
	}
} *&gt;&amp;1 &gt;&gt; 'C:\Windows\Setup\Scripts\MakeEdgeUninstallable.log';
		</File>
		<File path="C:\Windows\Setup\Scripts\SetStartPins.ps1">
$json = '{"pinnedList":[]}';
if( [System.Environment]::OSVersion.Version.Build -lt 20000 ) {
	return;
}
$key = 'Registry::HKLM\SOFTWARE\Microsoft\PolicyManager\current\device\Start';
New-Item -Path $key -ItemType 'Directory' -ErrorAction 'SilentlyContinue';
Set-ItemProperty -LiteralPath $key -Name 'ConfigureStartPins' -Value $json -Type 'String';
		</File>
		<File path="C:\Users\Default\AppData\Local\Microsoft\Windows\Shell\LayoutModification.xml">
&lt;LayoutModificationTemplate Version="1" xmlns="http://schemas.microsoft.com/Start/2014/LayoutModification"&gt;
	&lt;LayoutOptions StartTileGroupCellWidth="6" /&gt;
	&lt;DefaultLayoutOverride&gt;
		&lt;StartLayoutCollection&gt;
			&lt;StartLayout GroupCellWidth="6" xmlns="http://schemas.microsoft.com/Start/2014/FullDefaultLayout" /&gt;
		&lt;/StartLayoutCollection&gt;
	&lt;/DefaultLayoutOverride&gt;
&lt;/LayoutModificationTemplate&gt;
		</File>
		<File path="C:\Windows\Setup\Scripts\SetColorTheme.ps1">
$lightThemeSystem = 0;
$lightThemeApps = 0;
$accentColorOnStart = 0;
$enableTransparency = 0;
$htmlAccentColor = '#CF05A7';
&amp; {
	$params = @{
		LiteralPath = 'Registry::HKCU\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize';
		Force = $true;
		Type = 'DWord';
	};
	Set-ItemProperty @params -Name 'SystemUsesLightTheme' -Value $lightThemeSystem;
	Set-ItemProperty @params -Name 'AppsUseLightTheme' -Value $lightThemeApps;
	Set-ItemProperty @params -Name 'ColorPrevalence' -Value $accentColorOnStart;
	Set-ItemProperty @params -Name 'EnableTransparency' -Value $enableTransparency;
};
&amp; {
	Add-Type -AssemblyName 'System.Drawing';
	$accentColor = [System.Drawing.ColorTranslator]::FromHtml( $htmlAccentColor );

	function ConvertTo-DWord {
		param(
			[System.Drawing.Color]
			$Color
		);
						
		[byte[]] $bytes = @(
			$Color.R;
			$Color.G;
			$Color.B;
			$Color.A;
		);
		return [System.BitConverter]::ToUInt32( $bytes, 0); 
	}

	$startColor = [System.Drawing.Color]::FromArgb( 0xD2, $accentColor );
	Set-ItemProperty -LiteralPath 'Registry::HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Accent' -Name 'StartColorMenu' -Value( ConvertTo-DWord -Color $accentColor ) -Type 'DWord' -Force;
	Set-ItemProperty -LiteralPath 'Registry::HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Accent' -Name 'AccentColorMenu' -Value( ConvertTo-DWord -Color $accentColor ) -Type 'DWord' -Force;
	Set-ItemProperty -LiteralPath 'Registry::HKCU\Software\Microsoft\Windows\DWM' -Name 'AccentColor' -Value( ConvertTo-DWord -Color $accentColor ) -Type 'DWord' -Force;
	$params = @{
		LiteralPath = 'Registry::HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Accent';
		Name = 'AccentPalette';
	};
	$palette = Get-ItemPropertyValue @params;
	$index = 20;
	$palette[ $index++ ] = $accentColor.R;
	$palette[ $index++ ] = $accentColor.G;
	$palette[ $index++ ] = $accentColor.B;
	$palette[ $index++ ] = $accentColor.A;
	Set-ItemProperty @params -Value $palette -Type 'Binary' -Force;
};
		</File>
		<File path="C:\Windows\Setup\Scripts\unattend-01.ps1">
# Windows Debloat - System Setup Script
# Applies system tweaks for performance, telemetry reduction, and gaming

$logDir = Join-Path $env:TEMP "WinDebloatLogs"
if (-not (Test-Path $logDir)) { New-Item -ItemType Directory -Path $logDir -Force | Out-Null }
$timestamp = Get-Date -Format "yyyyMMdd_HHmmss"
Start-Transcript -Path (Join-Path $logDir "00_SystemSetup_$timestamp.log") -Append -Force
$start = Get-Date

function Write-LoggedOperation {
    param ([scriptblock]$Block, [string]$Description)
    Write-Host "`n[INFO] $Description"
    try { &amp; $Block; Write-Host "[SUCCESS] $Description completed" } 
    catch { Write-Host "[ERROR] $Description failed: $($_.Exception.Message)" }
}

# Windows Update
Write-LoggedOperation {
    reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\DriverSearching" /v SearchOrderConfig /t REG_DWORD /d 1 /f
} "Setting Windows Update driver search priority"

# Disable telemetry tasks
Write-LoggedOperation {
    $tasks = @(
        "Microsoft\Windows\Application Experience\Microsoft Compatibility Appraiser",
        "Microsoft\Windows\Application Experience\ProgramDataUpdater",
        "Microsoft\Windows\Autochk\Proxy",
        "Microsoft\Windows\Customer Experience Improvement Program\Consolidator",
        "Microsoft\Windows\Customer Experience Improvement Program\UsbCeip",
        "Microsoft\Windows\DiskDiagnostic\Microsoft-Windows-DiskDiagnosticDataCollector",
        "Microsoft\Windows\Feedback\Siuf\DmClient",
        "Microsoft\Windows\Feedback\Siuf\DmClientOnScenarioDownload",
        "Microsoft\Windows\Windows Error Reporting\QueueReporting",
        "Microsoft\Windows\Application Experience\MareBackup",
        "Microsoft\Windows\Application Experience\StartupAppTask",
        "Microsoft\Windows\Application Experience\PcaPatchDbTask",
        "Microsoft\Windows\Maps\MapsUpdateTask",
        "Microsoft\Windows\Windows Feeds\UpdateFeeds"
    )
    foreach ($task in $tasks) { schtasks /Change /TN $task /Disable | Out-Null }
} "Disabling telemetry tasks"

# Clear telemetry task cache
Write-LoggedOperation {
    $taskGUIDs = @(
        "{0600DD45-FAF2-4131-A006-0B17509B9F78}", # Microsoft\Windows\Application Experience\Microsoft Compatibility Appraiser
        "{4738DE7A-BCC1-4E2D-B1B0-CADB044BFA81}", # Microsoft\Windows\Application Experience\ProgramDataUpdater
        "{6FAC31FA-4A85-4E64-BFD5-2154FF4594B3}", # Microsoft\Windows\Application Experience\StartupAppTask
        "{FC931F16-B50A-472E-B061-B6F79A71EF59}", # Microsoft\Windows\Application Experience\AitAgent
        "{0671EB05-7D95-4153-A32B-1426B9FE61DB}", # Microsoft\Windows\Application Experience\PcaPatchDbTask
        "{87BF85F4-2CE1-4160-96EA-52F554AA28A2}", # Microsoft\Windows\Application Experience\Sdbinst
        "{8A9C643C-3D74-4099-B6BD-9C6D170898B1}", # Microsoft\Windows\Application Experience\Microsoft Compatibility Appraiser
        "{E3176A65-4E44-4ED3-AA73-3283660ACB9C}"  # Microsoft\Windows\Application Experience\StartupAppTask
    )
    foreach ($guid in $taskGUIDs) { reg.exe delete "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks\$guid" /f | Out-Null }
} "Clearing telemetry task cache"

# Power &amp; Performance
Write-LoggedOperation {
    $result = powercfg.exe /DUPLICATESCHEME e9a42b02-d5df-448d-aa00-03f14749eb61
    if ($result -match '\s([a-f0-9-]{36})\s') { powercfg.exe /SETACTIVE $Matches[1] }
} "Activating Ultimate Performance power plan"

Write-LoggedOperation {
    reg.exe add "HKLM\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters" /v IRPStackSize /t REG_DWORD /d 30 /f
} "Increasing IRP Stack Size for better network performance"

Write-LoggedOperation {
    try {
        # Calculate optimal svchost split threshold based on system RAM
        $ramKB = (Get-CimInstance Win32_PhysicalMemory | Measure-Object Capacity -Sum).Sum / 1KB
        if ($ramKB -le 0) {
            throw "Invalid RAM calculation result"
        }
        Set-ItemProperty -Path HKLM:\SYSTEM\CurrentControlSet\Control -Name SvcHostSplitThresholdInKB -Value [int]$ramKB -Force
    } catch {
        throw "RAM optimization failed: $($_.Exception.Message)"
    }
} "Optimizing svchost split threshold based on system RAM"
#endregion

# Power settings
Write-LoggedOperation {
    powercfg -hibernate off

    # Disable standby timeouts
    Write-Host "&#x2192; Disabling AC standby timeout"
    powercfg /change standby-timeout-ac 0

    Write-Host "&#x2192; Disabling DC standby timeout"
    powercfg /change standby-timeout-dc 0

    # Disable monitor timeouts
    Write-Host "&#x2192; Disabling monitor timeout (AC)"
    powercfg /change monitor-timeout-ac 0

    Write-Host "&#x2192; Disabling monitor timeout (DC)"
    powercfg /change monitor-timeout-dc 0
} "Configuring power settings for maximum performance"
#endregion

# Gaming priority
Write-LoggedOperation {
    reg.exe add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" /v "GPU Priority" /t REG_DWORD /d 8 /f
    reg.exe add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" /v Priority /t REG_DWORD /d 6 /f
    reg.exe add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" /v "Scheduling Category" /t REG_SZ /d High /f
} "Configuring gaming priority"

# Policy hardening
Write-LoggedOperation {
    reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\Windows Error Reporting" /v Disabled /t REG_DWORD /d 1 /f
} "Disabling Windows Error Reporting"

Write-LoggedOperation {
    reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\AdvertisingInfo" /v DisabledByGroupPolicy /t REG_DWORD /d 1 /f
} "Disabling Advertising ID globally"

Write-LoggedOperation {
    reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\Explorer" /v NoPinningStoreToTaskbar /t REG_DWORD /d 1 /f
} "Preventing Microsoft Store from being pinned to taskbar"

# Start menu &amp; feeds
Write-LoggedOperation {
    reg.exe add "HKLM\SOFTWARE\Microsoft\PolicyManager\Current\Device\Start" /v ConfigureStartPins /t REG_SZ /d '{ "pinnedList": [] }' /f
    reg.exe add "HKLM\SOFTWARE\Microsoft\PolicyManager\Current\Device\Start" /v ConfigureStartPins_ProviderSet /t REG_DWORD /d 1 /f
    reg.exe add "HKLM\SOFTWARE\Microsoft\PolicyManager\Current\Device\Start" /v ConfigureStartPins_WinningProvider /t REG_SZ /d B5292708-1619-419B-9923-E5D9F3925E71 /f
} "Clearing Start menu pinned tiles"

Write-LoggedOperation {
    reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\Windows Feeds" /v EnableFeeds /t REG_DWORD /d 0 /f
} "Disabling News and Interests from taskbar"

# Firewall
#Write-LoggedOperation {
#    New-NetFirewallRule -DisplayName 'ICMPv4' -Profile Any -Protocol ICMPv4
#    New-NetFirewallRule -DisplayName 'ICMPv6' -Profile Any -Protocol ICMPv6
#} "Allowing ICMP ping"

$runtime = (Get-Date) - $start
Write-Host "`nCompleted in $([math]::Round($runtime.TotalSeconds, 2)) seconds."
Stop-Transcript
		</File>
		<File path="C:\Windows\Setup\Scripts\unattend-02.ps1">
# Windows Debloat - UI Tweaks Script
# Applies Explorer and taskbar behavior tweaks and privacy settings

$logDir = Join-Path $env:TEMP "WinDebloatLogs"
if (-not (Test-Path $logDir)) { New-Item -ItemType Directory -Path $logDir -Force | Out-Null }
$timestamp = Get-Date -Format "yyyyMMdd_HHmmss"
Start-Transcript -Path (Join-Path $logDir "01_UI_Tweaks_$timestamp.log") -Append -Force
$start = Get-Date

function Write-LoggedOperation {
    param ([scriptblock]$Block, [string]$Description)
    Write-Host "`n[INFO] $Description"
    try { &amp; $Block; Write-Host "[SUCCESS] $Description completed" } 
    catch { Write-Host "[ERROR] $Description failed: $($_.Exception.Message)" }
}

# Explorer &amp; UI Tweaks
Write-LoggedOperation {
    # Taskbar and Widgets
    Write-Host "&#x2192; Removing Widgets"
    reg.exe add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v TaskbarDa /t REG_DWORD /d 0 /f

    # Notepad Settings
    Write-Host "&#x2192; Removing Store banner in Notepad"
    reg.exe add "HKCU\SOFTWARE\Microsoft\Notepad" /v ShowStoreBanner /t REG_DWORD /d 0 /f

    # File Explorer Behavior
    Write-Host "&#x2192; Setting File Explorer to open 'This PC'"
    reg.exe add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v LaunchTo /t REG_DWORD /d 1 /f

    # Alt+Tab Behavior
    Write-Host "&#x2192; Setting Alt+Tab to show only open windows"
    reg.exe add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v MultiTaskingAltTabFilter /t REG_DWORD /d 3 /f

    # Window Management
    Write-Host "&#x2192; Disabling Snap Assist Flyout"
    reg.exe add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v SnapAssist /t REG_DWORD /d 0 /f

    # Store Integration
    Write-Host "&#x2192; Preventing Store app pinning to taskbar"
    reg.exe add "HKCU\SOFTWARE\Policies\Microsoft\Windows\Explorer" /v NoPinningStoreToTaskbar /t REG_DWORD /d 1 /f
} "Applying File Explorer and taskbar behavior tweaks"
#endregion

# Desktop cleanup
Write-LoggedOperation {
    Remove-Item "$env:USERPROFILE\Desktop\Microsoft Edge.lnk" -Force -ErrorAction SilentlyContinue
} "Removing Microsoft Edge shortcut from Desktop"

# Taskbar icons &amp; news
Write-LoggedOperation {
    # News and Interests Panel
    Write-Host "&#x2192; Disabling News and Interests panel"
    reg.exe add "HKCU\Software\Microsoft\Windows\CurrentVersion\Feeds" /v ShellFeedsEnabled /t REG_DWORD /d 0 /f

    # News and Interests Hover
    Write-Host "&#x2192; Disabling News and Interests hover popup"
    reg.exe add "HKCU\Software\Microsoft\Windows\CurrentVersion\Feeds" /v ShellFeedsTaskbarOpenOnHover /t REG_DWORD /d 0 /f

    # Meet Now Button
    Write-Host "&#x2192; Hiding Meet Now button from taskbar"
    reg.exe add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer" /v HideSCAMeetNow /t REG_DWORD /d 1 /f
} "Disabling taskbar news, widgets, and chat icons"

# Privacy &amp; telemetry
Write-LoggedOperation {
    # Language and Personalization
    Write-Host "&#x2192; Disabling language list sharing with websites"
    reg.exe add "HKCU\Control Panel\International\User Profile" /v HttpAcceptLanguageOptOut /t REG_DWORD /d 1 /f

    Write-Host "&#x2192; Disabling personalization consent"
    reg.exe add "HKCU\SOFTWARE\Microsoft\Personalization\Settings" /v AcceptedPrivacyPolicy /t REG_DWORD /d 0 /f

    # Input Collection
    Write-Host "&#x2192; Disabling collection of typed text and handwriting"
    reg.exe add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\InputPersonalization" /v RestrictImplicitTextCollection /t REG_DWORD /d 1 /f
    reg.exe add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\InputPersonalization" /v RestrictImplicitInkCollection /t REG_DWORD /d 1 /f

    # Feedback and Telemetry
    Write-Host "&#x2192; Disabling feedback sampling and related services"
    reg.exe add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Feedback" /v AutoSample /t REG_DWORD /d 0 /f
    reg.exe add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Feedback" /v ServiceEnabled /t REG_DWORD /d 0 /f

    # Telemetry and Advertising
    Write-Host "&#x2192; Disabling telemetry and advertising ID features"
    reg.exe add "HKCU\SOFTWARE\Microsoft\Siuf\Rules" /v NumberOfSIUFInPeriod /t REG_DWORD /d 0 /f
    reg.exe add "HKCU\SOFTWARE\Policies\Microsoft\Windows\CloudContent" /v DisableTailoredExperiencesWithDiagnosticData /t REG_DWORD /d 1 /f
    reg.exe add "HKCU\SOFTWARE\Policies\Microsoft\Windows\CloudContent" /v DisableWindowsConsumerFeatures /t REG_DWORD /d 1 /f
    reg.exe add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\AdvertisingInfo" /v Enabled /t REG_DWORD /d 0 /f
} "Applying privacy and telemetry restrictions"
#endregion

#region Telemetry &amp; Customer Experience
# ===================================
# Customer Experience and Telemetry Settings
# ===================================
Write-LoggedOperation {
    # Disable Customer Experience Improvement Program
    Write-Host "&#x2192; Disabling Customer Experience Improvement Program"
    reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\SQMClient" /v CEIPEnable /t REG_DWORD /d 0 /f

    # Disable Application Telemetry
    Write-Host "&#x2192; Disabling Application Telemetry"
    reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\AppCompat" /v AITEnable /t REG_DWORD /d 0 /f

    # Disable Inventory Collection
    Write-Host "&#x2192; Disabling Inventory Collection"
    reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\AppCompat" /v DisableInventory /t REG_DWORD /d 1 /f

    # Disable Program Compatibility Assistant
    Write-Host "&#x2192; Disabling Program Compatibility Assistant"
    reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\AppCompat" /v DisablePCA /t REG_DWORD /d 1 /f

    # Disable Application Telemetry
    Write-Host "&#x2192; Disabling Application Telemetry"
    reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\AppCompat" /v DisableUAR /t REG_DWORD /d 1 /f
} "Disabling telemetry and customer experience tasks"

$runtime = (Get-Date) - $start
Write-Host "`nCompleted in $([math]::Round($runtime.TotalSeconds, 2)) seconds."
Stop-Transcript
		</File>
		<File path="C:\Windows\Setup\Scripts\unattend-03.ps1">
# Windows Debloat - SysPrep Debloater Script
# Removes bloatware and unnecessary components from Windows

$logDir = Join-Path $env:TEMP "WinDebloatLogs"
if (-not (Test-Path $logDir)) { New-Item -ItemType Directory -Path $logDir -Force | Out-Null }
$timestamp = Get-Date -Format "yyyyMMdd_HHmmss"
Start-Transcript -Path (Join-Path $logDir "02_SysPrep_Debloater_$timestamp.log") -Append -Force
$start = Get-Date

function Write-LoggedOperation {
    param ([scriptblock]$Block, [string]$Description)
    Write-Host "`n[INFO] $Description"
    try { &amp; $Block; Write-Host "[SUCCESS] $Description completed" } 
    catch { Write-Host "[ERROR] $Description failed: $($_.Exception.Message)" }
}

# App removal
Write-LoggedOperation {
    $appsToRemove = @(
        'Microsoft.Microsoft3DViewer'
        'Microsoft.BingSearch'
        'Microsoft.BingFinance'
        'Microsoft.BingSports'
        'Microsoft.BingNews'
        'Microsoft.BingWeather'
        'Microsoft.BingTravel'
        'Microsoft.BingFoodAndDrink'
        'Microsoft.BingHealthAndFitness'
        'Microsoft.BingTranslator'
        'Microsoft.Wallet'
        'Microsoft.WindowsCamera'
        'Clipchamp.Clipchamp'
        'Microsoft.549981C3F5F10'
        '*DevHome*'
        'MicrosoftCorporationII.MicrosoftFamily'
        'Microsoft.WindowsFeedbackHub'
        'Microsoft.GetHelp'
        'microsoft.windowscommunicationsapps'
        'Microsoft.WindowsMaps'
        'Microsoft.ZuneVideo'
        'Microsoft.MicrosoftOfficeHub'
        'Microsoft.Office.OneNote'
        'Microsoft.OutlookForWindows'
        'Microsoft.MSPaint'
        'Microsoft.People'
        'Microsoft.Windows.Photos'
        'Microsoft.PowerAutomateDesktop'
        'MicrosoftCorporationII.QuickAssist'
        'Microsoft.SkypeApp'
        'Microsoft.ScreenSketch'
        'Microsoft.MicrosoftSolitaireCollection'
        'MSTeams'
        'Microsoft.Getstarted'
        'Microsoft.WindowsSoundRecorder'
        'Microsoft.ZuneMusic'
        'Microsoft.Xbox.TCUI'
        'Microsoft.XboxGameOverlay'
        'Microsoft.XboxGamingOverlay'
        'Microsoft.XboxSpeechToTextOverlay'
        'Microsoft.GamingApp'
        'Microsoft.YourPhone'
        'Microsoft.OneDrive'
        'Microsoft.MixedReality.Portal'
        'Microsoft.Windows.Ai.Copilot.Provider'
        'Microsoft.WindowsMeetNow'
        'Microsoft.Office.Lens'
        '*CandyCrush*'
        '*Netflix*'
    )

    foreach ($app in $appsToRemove) {
        Get-AppxPackage -Name $app -AllUsers | Remove-AppxPackage -ErrorAction SilentlyContinue
    }
} "Removing Windows Store apps"

# Service disabling
Write-LoggedOperation {
    $servicesToDisable = @(
        "DiagTrack"
        "dmwappushservice"
        "HomeGroupListener"
        "HomeGroupProvider"
        "lfsvc"
        "MapsBroker"
        "NetTcpPortSharing"
        "RemoteAccess"
        "RemoteRegistry"
        "SharedAccess"
        "TrkWks"
        "WbioSrvc"
        "WMPNetworkSvc"
        "WwanSvc"
    )

    foreach ($service in $servicesToDisable) {
        Stop-Service -Name $service -Force -ErrorAction SilentlyContinue
        Set-Service -Name $service -StartupType Disabled -ErrorAction SilentlyContinue
    }
} "Disabling unnecessary services"

# Task removal
Write-LoggedOperation {
    $tasksToRemove = @(
        "\Microsoft\Windows\Application Experience\Microsoft Compatibility Appraiser"
        "\Microsoft\Windows\Application Experience\ProgramDataUpdater"
        "\Microsoft\Windows\Application Experience\StartupAppTask"
        "\Microsoft\Windows\Customer Experience Improvement Program\Consolidator"
        "\Microsoft\Windows\Customer Experience Improvement Program\UsbCeip"
        "\Microsoft\Windows\DiskDiagnostic\Microsoft-Windows-DiskDiagnosticDataCollector"
    )
    foreach ($task in $tasksToRemove) {
        Unregister-ScheduledTask -TaskName $task -Confirm:$false -ErrorAction SilentlyContinue
    }
} "Removing scheduled tasks"

# Cleanup
Write-LoggedOperation {
    Stop-Service -Name wuauserv -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:windir\SoftwareDistribution\*" -Recurse -Force -ErrorAction SilentlyContinue
    Start-Service -Name wuauserv -ErrorAction SilentlyContinue
    Remove-Item "$env:TEMP\*" -Recurse -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:windir\Temp\*" -Recurse -Force -ErrorAction SilentlyContinue

    # Clear Windows Error Reports
    Remove-Item "$env:ProgramData\Microsoft\Windows\WER\*" -Recurse -Force -ErrorAction SilentlyContinue
} "Cleaning up temporary files"

$runtime = (Get-Date) - $start
Write-Host "`nCompleted in $([math]::Round($runtime.TotalSeconds, 2)) seconds."
Stop-Transcript
		</File>
		<File path="C:\Windows\Setup\Scripts\unattend-04.ps1">
# Windows Debloat - Winget Application Installation Script
# Installs Winget if not present and installs a set of applications

$logDir = Join-Path $env:TEMP "WinDebloatLogs"
if (-not (Test-Path $logDir)) { New-Item -ItemType Directory -Path $logDir -Force | Out-Null }
$timestamp = Get-Date -Format "yyyyMMdd_HHmmss"
Start-Transcript -Path (Join-Path $logDir "03_Winget_Apps_$timestamp.log") -Append -Force
$start = Get-Date

# Configuration
$RemoveShortcuts = $true
$appList = @(
    "EpicGames.EpicGamesLauncher"
    "Valve.Steam"
    "Discord.Discord"
    "Spotify.Spotify"
    "Zen-Team.Zen-Browser"
    "Microsoft.WindowsTerminal"
    "voidtools.Everything"
)
$shortcutFragments = $appList | ForEach-Object { ($_ -split '\.')[1] } | Where-Object { $_ }

function Write-LoggedOperation {
    param (
        [scriptblock]$Block,
        [string]$Description
    )
    Write-Host "`n[INFO] $Description"
    try { &amp; $Block; Write-Host "[SUCCESS] $Description completed" } 
    catch { Write-Host "[ERROR] $Description failed: $($_.Exception.Message)" }
}

function Remove-Shortcut {
    param (
        [Parameter(Mandatory = $true)]
        [string[]]$NameFragments
    )

    $shortcutPaths = @(
        "$env:USERPROFILE\Desktop",
        "C:\Users\Public\Desktop"
    )

    foreach ($path in $shortcutPaths) {
        foreach ($fragment in $NameFragments) {
            Get-ChildItem -Path $path -Filter *.lnk -ErrorAction SilentlyContinue |
                Where-Object { $_.Name -match [regex]::Escape($fragment) } |
                ForEach-Object {
                    Write-Host "`n[INFO] Found shortcut matching '$fragment': $($_.FullName)"
                    Write-LoggedOperation {
                        Remove-Item $_.FullName -Force -ErrorAction SilentlyContinue
                    } "Removing shortcut: $($_.Name)"
                }
        }
    }
}

# Path setup
$VCLibs       = "$env:TEMP\Microsoft.VCLibs.x64.14.00.Desktop.appx"
$UIXaml       = "$env:TEMP\Microsoft.UI.Xaml.2.8.x64.appx"
$winget       = "$env:TEMP\winget.msixbundle"

$VCLibsUrl    = "https://aka.ms/Microsoft.VCLibs.x64.14.00.Desktop.appx"
$UIXamlUrl    = "https://github.com/microsoft/microsoft-ui-xaml/releases/download/v2.8.6/Microsoft.UI.Xaml.2.8.x64.appx"
$wingetUrl    = "https://api.github.com/repos/microsoft/winget-cli/releases/latest"

# Dependencies
Write-LoggedOperation {
    &amp; curl.exe -L -o $VCLibs $VCLibsUrl
    Add-AppxPackage -Path $VCLibs
} "Installing Microsoft.VCLibs (UWP C++ runtime)"

Write-LoggedOperation {
    &amp; curl.exe -L -o $UIXaml $UIXamlUrl
    Add-AppxPackage -Path $UIXaml
} "Installing Microsoft.UI.Xaml (UI framework)"

# Winget installation
Write-LoggedOperation {
    [Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
    $bundle = (Invoke-RestMethod $wingetUrl).assets | Where-Object { $_.name -like "*.msixbundle" } | Select-Object -First 1
    &amp; curl.exe -L -J -o $winget $bundle.browser_download_url
    if (-Not (Test-Path $winget)) { throw "Download failed: $winget was not created." }
    Add-AppxPackage -Path $winget
} "Installing winget (Windows Package Manager)"

# Winget verification
Set-Variable -Name wingetAvailable -Value $false -Scope Script
Write-LoggedOperation {
    winget --version | Out-Null
    $script:wingetAvailable = $true
} "Verifying winget is available"

# Application installation
if ($wingetAvailable) {
    Write-LoggedOperation {
        Remove-Item -LiteralPath $winget -Force -ErrorAction SilentlyContinue
        Remove-Item -LiteralPath $UIXaml -Force -ErrorAction SilentlyContinue
        Remove-Item -LiteralPath $VCLibs -Force -ErrorAction SilentlyContinue
    } "Cleaning up temporary files"

    # Install applications
    foreach ($app in $appList) {
        Write-LoggedOperation {
            winget install --id=$app -e --accept-source-agreements --accept-package-agreements
        } "Installing $app"
    }

    # Optional shortcut cleanup
    if ($RemoveShortcuts) {
        Write-LoggedOperation {
            Remove-Shortcut -NameFragments $shortcutFragments
        } "Removing desktop shortcuts for installed apps"
    }
} else {
    Write-Host "`n[WARNING] winget is not available. Skipping app installations and cleanup."
}

$runtime = (Get-Date) - $start
Write-Host "`nCompleted in $([math]::Round($runtime.TotalSeconds, 2)) seconds."
Stop-Transcript
		</File>
		<File path="C:\Windows\Setup\Scripts\unattend-05.ps1">
# Windows Debloat - User Setup Script
# Configures keyboard layout, wallpaper, shortcuts, and Windows activation

$logDir = Join-Path $env:TEMP "WinDebloatLogs"
if (-not (Test-Path $logDir)) { New-Item -ItemType Directory -Path $logDir -Force | Out-Null }
$timestamp = Get-Date -Format "yyyyMMdd_HHmmss"
Start-Transcript -Path (Join-Path $logDir "04_UserSetup_$timestamp.log") -Append -Force
$start = Get-Date

function Write-LoggedOperation {
    param ([scriptblock]$Block, [string]$Description)
    Write-Host "`n[INFO] $Description"
    try { &amp; $Block; Write-Host "[SUCCESS] $Description completed" } 
    catch { Write-Host "[ERROR] $Description failed: $($_.Exception.Message)" }
}

# Keyboard layout
Write-LoggedOperation {
    # To customize: Run Get-WinUserLanguageList to view input/language codes
    # Replace 'en-CA' and '1009:00011009' with your own layout if desired
    $langList = New-WinUserLanguageList "en-CA"
    $langList[0].InputMethodTips.Clear()
    $langList[0].InputMethodTips.Add("1009:00011009")  # Canadian Multilingual Standard
    Set-WinUserLanguageList $langList -Force
} "Setting keyboard layout to English (Canada) - Canadian Multilingual"
#endregion

# Wallpaper
$W10_Wallpaper = "C:\Windows\Web\Wallpaper\Theme1\img4.jpg"
$W11_Wallpaper = "C:\Windows\Web\Wallpaper\ThemeA\img20.jpg"

Write-LoggedOperation {
    $wallpaperToApply = if (Test-Path $W10_Wallpaper) { $W10_Wallpaper }
    elseif (Test-Path $W11_Wallpaper) { $W11_Wallpaper }
    else { return }
    
    Set-ItemProperty -Path 'HKCU:\Control Panel\Desktop' -Name WallPaper -Value $wallpaperToApply
    Set-ItemProperty -Path 'HKCU:\Control Panel\Desktop' -Name WallpaperStyle -Value "10"  # Fill
    Set-ItemProperty -Path 'HKCU:\Control Panel\Desktop' -Name TileWallpaper -Value "0"     # No Tile
    Start-Process -FilePath rundll32.exe -ArgumentList 'user32.dll,UpdatePerUserSystemParameters' -NoNewWindow -Wait
} "Applying default wallpaper"

# Shortcut management
Write-LoggedOperation {
    Remove-Item "$env:USERPROFILE\Desktop\Microsoft Edge.lnk" -Force -ErrorAction SilentlyContinue
} "Removing Microsoft Edge shortcut from Desktop"

Write-LoggedOperation {
    $ncpa = (New-Object -ComObject WScript.Shell).CreateShortcut("$env:USERPROFILE\Desktop\Network Connections.lnk")
    $ncpa.TargetPath       = "$env:windir\explorer.exe"
    $ncpa.Arguments        = "shell:::{992CFFA0-F557-101A-88EC-00DD010CCC48}"
    $ncpa.WorkingDirectory = "$env:windir"
    $ncpa.IconLocation     = "$env:SystemRoot\System32\netshell.dll"
    $ncpa.Save()
} "Creating 'Network Connections' shortcut on Desktop"

# Startup apps
Write-LoggedOperation {
    reg.exe delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" /v SecurityHealth /f
    
    Write-Host "&#x2192; Removing Edge autolaunch startup"
    $runKey = "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run"
    Get-ItemProperty -Path "Registry::$runKey" | 
        Get-Member -MemberType NoteProperty |
        Where-Object { $_.Name -like "MicrosoftEdgeAutoLaunch_*" } |
        ForEach-Object { Remove-ItemProperty -Path "Registry::$runKey" -Name $_.Name -Force }
} "Setting up user preferences"

# Tools
Write-LoggedOperation {
    curl.exe -L -s https://live.sysinternals.com/Autologon.exe -o "$env:USERPROFILE\Desktop\Autologon.exe"
} "Downloading Sysinternals Autologon to Desktop"

# Windows activation
Write-LoggedOperation {
    Write-Host "[DETAIL] Downloading and running TSForge activation script..."
    $tsPath = "$env:TEMP\TSforge_Activation.cmd"
    curl.exe -L -s https://raw.githubusercontent.com/massgravel/Microsoft-Activation-Scripts/master/MAS/Separate-Files-Version/Activators/TSforge_Activation.cmd -o $tsPath
    &amp; $tsPath /Z-Windows
    Remove-Item $tsPath -Force -ErrorAction SilentlyContinue
} "Running TSForge activation"

Write-Host "&#x2192; Restarting Explorer to apply changes"
taskkill /f /im explorer.exe | Out-Null
Start-Process explorer.exe

$runtime = (Get-Date) - $start
Write-Host "`nCompleted in $([math]::Round($runtime.TotalSeconds, 2)) seconds."
Stop-Transcript
		</File>
		<File path="C:\Windows\Setup\Scripts\unattend-06.ps1">
# Windows Debloat - Windows Optimizer Script
# Downloads and runs the latest Optimizer.exe with predefined configurations

$logDir = Join-Path $env:TEMP "WinDebloatLogs"
if (-not (Test-Path $logDir)) { New-Item -ItemType Directory -Path $logDir -Force | Out-Null }
$timestamp = Get-Date -Format "yyyyMMdd_HHmmss"
Start-Transcript -Path (Join-Path $logDir "05_WindowsOptimizer_$timestamp.log") -Append -Force
$start = Get-Date

function Write-LoggedOperation {
    param ([scriptblock]$Block, [string]$Description)
    Write-Host "`n[INFO] $Description"
    try { &amp; $Block; Write-Host "[SUCCESS] $Description completed" } 
    catch { Write-Host "[ERROR] $Description failed: $($_.Exception.Message)" }
}

# Configuration
$configJson = @'
{
    "WindowsVersion": "__OSVERSION__",
    "Tweaks": {
        "DisableTelemetry": true,
        "DisableErrorReporting": true,
        "DisableAdvertisingID": true,
        "DisableNewsAndInterests": true,
        "DisableStoreTaskbarPin": true,
        "DisableWidgets": true,
        "DisableFeedback": true,
        "DisableTailoredExperiences": true,
        "DisableConsumerFeatures": true,
        "DisableBackgroundApps": true,
        "DisableHibernation": true,
        "DisableNotifications": true,
        "DisableLocation": true,
        "DisableIPv6": true,
        "DisableSuggestedContent": true,
        "DisableSearchSuggestions": true,
        "DisableWiFiSense": true,
        "EnableUltimatePerformance": true,
        "HideTaskbarWeather": true,
        "DisableMyPeople": true,
        "EnableLongPaths": true,
        "DisableTPMCheck": true,
        "DisableSensorServices": true,
        "RemoveCastToDevice": true,
        "RestoreClassicPhotoViewer": true,
        "DisableModernStandby": true,
        "DisableAutomaticUpdates": true,
        "DisableStoreUpdates": true,
        "DisableInsiderService": true,
        "ExcludeDrivers": true,
        "DisableTelemetryServices": true,
        "DisableCortana": true,
        "DisablePrivacyOptions": true,
        "DisableStartMenuAds": true,
        "DisableEdgeTelemetry": true,
        "DisableEdgeDiscoverBar": true,
        "EnableGamingMode": true,
        "DisableXboxLive": true,
        "DisableGameBar": true,
        "DisableWindowsInk": true,
        "DisableSpellingTyping": true,
        "DisableCloudClipboard": true
    },
    "AdvancedTweaks": {
        "SvchostProcessSplitting": {
            "Disable": false,
            "RAM": null
        }
    },
    "Cleaner": {
        "RemovePUA": true,
        "RemoveOptionalFeatures": true,
        "RemoveOneDrive": true,
        "RemoveTeams": true
    },
    "RegistryFix": {
        "TaskManager": true,
        "CommandPrompt": true,
        "ControlPanel": true,
        "FolderOptions": true,
        "RunDialog": true,
        "RightClickMenu": true,
        "WindowsFirewall": true,
        "RegistryEditor": true
    },
    "Integrator": {
        "OpenWithCMD": true
    },
    "PostAction": {
        "Restart": true,
        "RestartType": "Normal"
    }
}
'@

# Apply OS version to config
try {
    $osVersion = if ([System.Environment]::OSVersion.Version.Build -ge 22000) { "11" } else { "10" }
    $configJson = $configJson -replace '"WindowsVersion":\s*"__OSVERSION__"', "`"WindowsVersion`": `"$osVersion`""
} catch {
    Write-Host "[WARNING] Could not determine OS version, defaulting to Windows 10"
    $configJson = $configJson -replace '"WindowsVersion":\s*"__OSVERSION__"', '"WindowsVersion": "10"'
}

# Download
Write-LoggedOperation {
    $release = Invoke-RestMethod "https://api.github.com/repos/hellzerg/optimizer/releases/latest" -Headers @{ "User-Agent" = "PS" }
    $exeUrl = ($release.assets | Where-Object name -like "*.exe").browser_download_url
    Invoke-WebRequest -Uri $exeUrl -OutFile "$env:TEMP\Optimizer.exe"
} "Downloading Optimizer.exe"

# Execution
Write-LoggedOperation {
    # Save config to file
    $configPath = "$env:TEMP\optimizer_config.json"
    $configJson | Out-File -FilePath $configPath -Encoding utf8 -Force

    # Run Optimizer with config
    $psi = New-Object System.Diagnostics.ProcessStartInfo
    $psi.FileName = "$env:TEMP\Optimizer.exe"
    $psi.Arguments = "/config=$configPath"
    $psi.RedirectStandardOutput = $true
    $psi.RedirectStandardError  = $true
    $psi.UseShellExecute = $false
    $psi.CreateNoWindow = $true

    $proc = New-Object System.Diagnostics.Process
    $proc.StartInfo = $psi
    $null = $proc.Start()

    $stdout = $proc.StandardOutput
    $stderr = $proc.StandardError

    while (-not $proc.HasExited) {
        while (!$stdout.EndOfStream) {
            $line = $stdout.ReadLine()
            if ($line) { Write-Host $line }
        }
        Start-Sleep -Milliseconds 100
    }

    while (!$stdout.EndOfStream) {
        $line = $stdout.ReadLine()
        if ($line) { Write-Host $line }
    }

    $errors = $stderr.ReadToEnd()
    if ($errors) { Write-Host "`n=== STDERR ===`n$errors" }
} "Running Optimizer with config"

# Cleanup
Write-LoggedOperation {
    Remove-Item "$env:TEMP\Optimizer.exe" -Force -ErrorAction SilentlyContinue
    Remove-Item "$env:TEMP\optimizer_config.json" -Force -ErrorAction SilentlyContinue
} "Cleaning up temporary files"

$runtime = (Get-Date) - $start
Write-Host "`nCompleted in $([math]::Round($runtime.TotalSeconds, 2)) seconds."
Stop-Transcript
		</File>
		<File path="C:\Windows\Setup\Scripts\unattend-07.ps1">
# Windows Debloat - WindowsSpyBlocker Automation Script
# Silently installs and runs the latest WindowsSpyBlocker to apply telemetry blocking rules

$logDir = Join-Path $env:TEMP "WinDebloatLogs"
if (-not (Test-Path $logDir)) { New-Item -ItemType Directory -Path $logDir -Force | Out-Null }
$timestamp = Get-Date -Format "yyyyMMdd_HHmmss"
Start-Transcript -Path (Join-Path $logDir "06_WindowsSpyBlocker_$timestamp.log") -Append -Force
$start = Get-Date

function Write-LoggedOperation {
    param ([scriptblock]$Block, [string]$Description)
    Write-Host "`n[INFO] $Description"
    try { &amp; $Block; Write-Host "[SUCCESS] $Description completed" } 
    catch { Write-Host "[ERROR] $Description failed: $($_.Exception.Message)" }
}

# Download
Write-LoggedOperation {
    $release = Invoke-RestMethod "https://api.github.com/repos/crazy-max/WindowsSpyBlocker/releases/latest" -Headers @{ "User-Agent" = "PS" }
    $exeUrl = ($release.assets | Where-Object name -like "*.exe").browser_download_url
    Invoke-WebRequest -Uri $exeUrl -OutFile "$env:TEMP\WindowsSpyBlocker.exe"
} "Downloading WindowsSpyBlocker.exe"

# Execution
Write-LoggedOperation {
    $psi = New-Object System.Diagnostics.ProcessStartInfo
    $psi.FileName = "$env:TEMP\WindowsSpyBlocker.exe"
    $psi.RedirectStandardInput  = $true
    $psi.RedirectStandardOutput = $true
    $psi.RedirectStandardError  = $true
    $psi.UseShellExecute = $false
    $psi.CreateNoWindow = $true

    $proc = New-Object System.Diagnostics.Process
    $proc.StartInfo = $psi
    $null = $proc.Start()

    $stdin  = $proc.StandardInput
    $stdout = $proc.StandardOutput
    $stderr = $proc.StandardError

    $stdin.WriteLine("1")
    Start-Sleep -Milliseconds 300
    $stdin.WriteLine("1")
    Start-Sleep -Milliseconds 300
    $stdin.WriteLine("1")
    Start-Sleep -Milliseconds 300
    $stdin.WriteLine("exit")
    $stdin.Close()

    while (-not $proc.HasExited) {
        while (!$stdout.EndOfStream) {
            $line = $stdout.ReadLine()
            if ($line) { Write-Host $line }
        }
        Start-Sleep -Milliseconds 100
    }

    while (!$stdout.EndOfStream) {
        $line = $stdout.ReadLine()
        if ($line) { Write-Host $line }
    }

    $errors = $stderr.ReadToEnd()
    if ($errors) { Write-Host "`n=== STDERR ===`n$errors" }
} "Running WindowsSpyBlocker silently"

# Cleanup
Write-LoggedOperation {
    $pathsToDelete = @(
        "$env:TEMP\libs",
        "$env:TEMP\logs",
        "$env:TEMP\tmp",
        "$env:TEMP\app.conf",
        "$env:TEMP\WindowsSpyBlocker.exe"
    )
    foreach ($path in $pathsToDelete) {
        if (Test-Path $path) {
            Remove-Item $path -Recurse -Force -ErrorAction SilentlyContinue
        }
    }
} "Cleaning up WindowsSpyBlocker files"

$runtime = (Get-Date) - $start
Write-Host "`nCompleted in $([math]::Round($runtime.TotalSeconds, 2)) seconds."
Stop-Transcript
		</File>
		<File path="C:\Windows\Setup\Scripts\unattend-08.ps1">
# Windows Debloat - Winget Application Installation Script
# Installs Winget if not present and installs a set of applications

$logDir = Join-Path $env:TEMP "WinDebloatLogs"
if (-not (Test-Path $logDir)) { New-Item -ItemType Directory -Path $logDir -Force | Out-Null }
$timestamp = Get-Date -Format "yyyyMMdd_HHmmss"
Start-Transcript -Path (Join-Path $logDir "03_Winget_Apps_$timestamp.log") -Append -Force
$start = Get-Date

# Configuration
$RemoveShortcuts = $true
$appList = @(
    "EpicGames.EpicGamesLauncher"
    "Valve.Steam"
    "Discord.Discord"
    "Spotify.Spotify"
    "Zen-Team.Zen-Browser"
    "Microsoft.WindowsTerminal"
    "voidtools.Everything"
)
$shortcutFragments = $appList | ForEach-Object { ($_ -split '\.')[1] } | Where-Object { $_ }

function Write-LoggedOperation {
    param (
        [scriptblock]$Block,
        [string]$Description
    )
    Write-Host "`n[INFO] $Description"
    try { &amp; $Block; Write-Host "[SUCCESS] $Description completed" } 
    catch { Write-Host "[ERROR] $Description failed: $($_.Exception.Message)" }
}

function Remove-Shortcut {
    param (
        [Parameter(Mandatory = $true)]
        [string[]]$NameFragments
    )

    $shortcutPaths = @(
        "$env:USERPROFILE\Desktop",
        "C:\Users\Public\Desktop"
    )

    foreach ($path in $shortcutPaths) {
        foreach ($fragment in $NameFragments) {
            Get-ChildItem -Path $path -Filter *.lnk -ErrorAction SilentlyContinue |
                Where-Object { $_.Name -match [regex]::Escape($fragment) } |
                ForEach-Object {
                    Write-Host "`n[INFO] Found shortcut matching '$fragment': $($_.FullName)"
                    Write-LoggedOperation {
                        Remove-Item $_.FullName -Force -ErrorAction SilentlyContinue
                    } "Removing shortcut: $($_.Name)"
                }
        }
    }
}

# Path setup
$VCLibs       = "$env:TEMP\Microsoft.VCLibs.x64.14.00.Desktop.appx"
$UIXaml       = "$env:TEMP\Microsoft.UI.Xaml.2.8.x64.appx"
$winget       = "$env:TEMP\winget.msixbundle"

$VCLibsUrl    = "https://aka.ms/Microsoft.VCLibs.x64.14.00.Desktop.appx"
$UIXamlUrl    = "https://github.com/microsoft/microsoft-ui-xaml/releases/download/v2.8.6/Microsoft.UI.Xaml.2.8.x64.appx"
$wingetUrl    = "https://api.github.com/repos/microsoft/winget-cli/releases/latest"

# Dependencies
Write-LoggedOperation {
    &amp; curl.exe -L -o $VCLibs $VCLibsUrl
    Add-AppxPackage -Path $VCLibs
} "Installing Microsoft.VCLibs (UWP C++ runtime)"

Write-LoggedOperation {
    &amp; curl.exe -L -o $UIXaml $UIXamlUrl
    Add-AppxPackage -Path $UIXaml
} "Installing Microsoft.UI.Xaml (UI framework)"

# Winget installation
Write-LoggedOperation {
    [Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
    $bundle = (Invoke-RestMethod $wingetUrl).assets | Where-Object { $_.name -like "*.msixbundle" } | Select-Object -First 1
    &amp; curl.exe -L -J -o $winget $bundle.browser_download_url
    if (-Not (Test-Path $winget)) { throw "Download failed: $winget was not created." }
    Add-AppxPackage -Path $winget
} "Installing winget (Windows Package Manager)"

# Winget verification
Set-Variable -Name wingetAvailable -Value $false -Scope Script
Write-LoggedOperation {
    winget --version | Out-Null
    $script:wingetAvailable = $true
} "Verifying winget is available"

# Application installation
if ($wingetAvailable) {
    Write-LoggedOperation {
        Remove-Item -LiteralPath $winget -Force -ErrorAction SilentlyContinue
        Remove-Item -LiteralPath $UIXaml -Force -ErrorAction SilentlyContinue
        Remove-Item -LiteralPath $VCLibs -Force -ErrorAction SilentlyContinue
    } "Cleaning up temporary files"

    # Install applications
    foreach ($app in $appList) {
        Write-LoggedOperation {
            winget install --id=$app -e --accept-source-agreements --accept-package-agreements
        } "Installing $app"
    }

    # Optional shortcut cleanup
    if ($RemoveShortcuts) {
        Write-LoggedOperation {
            Remove-Shortcut -NameFragments $shortcutFragments
        } "Removing desktop shortcuts for installed apps"
    }
} else {
    Write-Host "`n[WARNING] winget is not available. Skipping app installations and cleanup."
}

$runtime = (Get-Date) - $start
Write-Host "`nCompleted in $([math]::Round($runtime.TotalSeconds, 2)) seconds."
Stop-Transcript
		</File>
		<File path="C:\Windows\Setup\Scripts\Specialize.ps1">
$scripts = @(
	{
		Get-Content -LiteralPath 'C:\Windows\Setup\Scripts\GetComputerName.ps1' -Raw | Invoke-Expression &gt; 'C:\Windows\Setup\Scripts\ComputerName.txt';
		Start-Process -FilePath ( Get-Process -Id $PID ).Path -ArgumentList '-NoProfile', '-Command', 'Get-Content -LiteralPath "C:\Windows\Setup\Scripts\SetComputerName.ps1" -Raw | Invoke-Expression;' -WindowStyle 'Hidden';
		Start-Sleep -Seconds 10;
	};
	{
		reg.exe add "HKLM\SYSTEM\Setup\MoSetup" /v AllowUpgradesWithUnsupportedTPMOrCPU /t REG_DWORD /d 1 /f;
	};
	{
		reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\OOBE" /v BypassNRO /t REG_DWORD /d 1 /f;
	};
	{
		Remove-Item -LiteralPath 'Registry::HKLM\Software\Microsoft\WindowsUpdate\Orchestrator\UScheduler_Oobe\DevHomeUpdate' -Force -ErrorAction 'SilentlyContinue';
	};
	{
		Remove-Item -LiteralPath 'C:\Users\Default\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\OneDrive.lnk', 'C:\Windows\System32\OneDriveSetup.exe', 'C:\Windows\SysWOW64\OneDriveSetup.exe' -ErrorAction 'Continue';
	};
	{
		Remove-Item -LiteralPath 'Registry::HKLM\Software\Microsoft\WindowsUpdate\Orchestrator\UScheduler_Oobe\OutlookUpdate' -Force -ErrorAction 'SilentlyContinue';
	};
	{
		reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Communications" /v ConfigureChatAutoInstall /t REG_DWORD /d 0 /f;
	};
	{
		Get-Content -LiteralPath 'C:\Windows\Setup\Scripts\RemovePackages.ps1' -Raw | Invoke-Expression;
	};
	{
		Get-Content -LiteralPath 'C:\Windows\Setup\Scripts\RemoveCapabilities.ps1' -Raw | Invoke-Expression;
	};
	{
		Get-Content -LiteralPath 'C:\Windows\Setup\Scripts\RemoveFeatures.ps1' -Raw | Invoke-Expression;
	};
	{
		net.exe accounts /maxpwage:UNLIMITED;
	};
	{
		Register-ScheduledTask -TaskName 'PauseWindowsUpdate' -Xml $( Get-Content -LiteralPath 'C:\Windows\Setup\Scripts\PauseWindowsUpdate.xml' -Raw );
	};
	{
		reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer" /v SmartScreenEnabled /t REG_SZ /d "Off" /f;
		reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WTDS\Components" /v ServiceEnabled /t REG_DWORD /d 0 /f;
		reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WTDS\Components" /v NotifyMalicious /t REG_DWORD /d 0 /f;
		reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WTDS\Components" /v NotifyPasswordReuse /t REG_DWORD /d 0 /f;
		reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WTDS\Components" /v NotifyUnsafeApp /t REG_DWORD /d 0 /f;
		reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows Defender Security Center\Systray" /v HideSystray /t REG_DWORD /d 1 /f;
	};
	{
		reg.exe add "HKLM\SYSTEM\CurrentControlSet\Control\FileSystem" /v LongPathsEnabled /t REG_DWORD /d 1 /f
	};
	{
		reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU" /v AUOptions /t REG_DWORD /d 4 /f;
		reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU" /v NoAutoRebootWithLoggedOnUsers /t REG_DWORD /d 1 /f;
	};
	{
		Register-ScheduledTask -TaskName 'MoveActiveHours' -Xml $( Get-Content -LiteralPath 'C:\Windows\Setup\Scripts\MoveActiveHours.xml' -Raw );
	};
	{
		reg.exe add "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Power" /v HiberbootEnabled /t REG_DWORD /d 0 /f;
	};
	{
		reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Dsh" /v AllowNewsAndInterests /t REG_DWORD /d 0 /f;
	};
	{
		reg.exe add "HKLM\Software\Policies\Microsoft\Windows\CloudContent" /v "DisableWindowsConsumerFeatures" /t REG_DWORD /d 1 /f;
	};
	{
		reg.exe add "HKLM\Software\Policies\Microsoft\Edge" /v HideFirstRunExperience /t REG_DWORD /d 1 /f;
	};
	{
		Get-Content -LiteralPath 'C:\Windows\Setup\Scripts\MakeEdgeUninstallable.ps1' -Raw | Invoke-Expression;
	};
	{
		Get-Content -LiteralPath 'C:\Windows\Setup\Scripts\SetStartPins.ps1' -Raw | Invoke-Expression;
	};
	{
		Set-ItemProperty -LiteralPath "Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects\ControlAnimations" -Name 'DefaultValue' -Value 1 -Type 'DWord' -Force;
		Set-ItemProperty -LiteralPath "Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects\AnimateMinMax" -Name 'DefaultValue' -Value 0 -Type 'DWord' -Force;
		Set-ItemProperty -LiteralPath "Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects\TaskbarAnimations" -Name 'DefaultValue' -Value 0 -Type 'DWord' -Force;
		Set-ItemProperty -LiteralPath "Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects\DWMAeroPeekEnabled" -Name 'DefaultValue' -Value 1 -Type 'DWord' -Force;
		Set-ItemProperty -LiteralPath "Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects\MenuAnimation" -Name 'DefaultValue' -Value 0 -Type 'DWord' -Force;
		Set-ItemProperty -LiteralPath "Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects\TooltipAnimation" -Name 'DefaultValue' -Value 0 -Type 'DWord' -Force;
		Set-ItemProperty -LiteralPath "Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects\SelectionFade" -Name 'DefaultValue' -Value 1 -Type 'DWord' -Force;
		Set-ItemProperty -LiteralPath "Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects\DWMSaveThumbnailEnabled" -Name 'DefaultValue' -Value 1 -Type 'DWord' -Force;
		Set-ItemProperty -LiteralPath "Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects\CursorShadow" -Name 'DefaultValue' -Value 0 -Type 'DWord' -Force;
		Set-ItemProperty -LiteralPath "Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects\ListviewShadow" -Name 'DefaultValue' -Value 1 -Type 'DWord' -Force;
		Set-ItemProperty -LiteralPath "Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects\ThumbnailsOrIcon" -Name 'DefaultValue' -Value 1 -Type 'DWord' -Force;
		Set-ItemProperty -LiteralPath "Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects\ListviewAlphaSelect" -Name 'DefaultValue' -Value 1 -Type 'DWord' -Force;
		Set-ItemProperty -LiteralPath "Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects\DragFullWindows" -Name 'DefaultValue' -Value 0 -Type 'DWord' -Force;
		Set-ItemProperty -LiteralPath "Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects\ComboBoxAnimation" -Name 'DefaultValue' -Value 1 -Type 'DWord' -Force;
		Set-ItemProperty -LiteralPath "Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects\FontSmoothing" -Name 'DefaultValue' -Value 1 -Type 'DWord' -Force;
		Set-ItemProperty -LiteralPath "Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects\ListBoxSmoothScrolling" -Name 'DefaultValue' -Value 1 -Type 'DWord' -Force;
		Set-ItemProperty -LiteralPath "Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects\DropShadow" -Name 'DefaultValue' -Value 0 -Type 'DWord' -Force;
	};
	{
		Get-Content -LiteralPath 'C:\Windows\Setup\Scripts\unattend-01.ps1' -Raw | Invoke-Expression;
	};
);

&amp; {
  [float] $complete = 0;
  [float] $increment = 100 / $scripts.Count;
  foreach( $script in $scripts ) {
    Write-Progress -Activity 'Running scripts to customize your Windows installation. Do not close this window.' -PercentComplete $complete;
    '*** Will now execute command &#xAB;{0}&#xBB;.' -f $(
      $str = $script.ToString().Trim() -replace '\s+', ' ';
      $max = 100;
      if( $str.Length -le $max ) {
        $str;
      } else {
        $str.Substring( 0, $max - 1 ) + '&#x2026;';
      }
    );
    $start = [datetime]::Now;
    &amp; $script;
    '*** Finished executing command after {0:0} ms.' -f [datetime]::Now.Subtract( $start ).TotalMilliseconds;
    "`r`n" * 3;
    $complete += $increment;
  }
} *&gt;&amp;1 &gt;&gt; "C:\Windows\Setup\Scripts\Specialize.log";
		</File>
		<File path="C:\Windows\Setup\Scripts\UserOnce.ps1">
$scripts = @(
	{
		Get-AppxPackage -Name 'Microsoft.Windows.Ai.Copilot.Provider' | Remove-AppxPackage;
	};
	{
		$params = @{
			Path = 'Registry::HKCU\Software\Classes\CLSID\{86ca1aa0-34aa-4e8b-a509-50c905bae2a2}\InprocServer32';
			ErrorAction = 'SilentlyContinue';
			Force = $true;
		};
		New-Item @params;
		Set-ItemProperty @params -Name '(Default)' -Value '' -Type 'String';
	};
	{
		Set-ItemProperty -LiteralPath 'Registry::HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced' -Name 'LaunchTo' -Type 'DWord' -Value 1;
	};
	{
		Set-ItemProperty -LiteralPath 'Registry::HKCU\Software\Microsoft\Windows\CurrentVersion\Search' -Name 'SearchboxTaskbarMode' -Type 'DWord' -Value 1;
	};
	{
		Set-ItemProperty -LiteralPath 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects' -Name 'VisualFXSetting' -Type 'DWord' -Value 3 -Force;
	};
	{
		New-Item -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\ClassicStartMenu' -Force;
		Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\ClassicStartMenu' -Name '{5399e694-6ce5-4d6c-8fce-1d8870fdcba0}' -Value 0 -Type 'DWord';
		Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\ClassicStartMenu' -Name '{b4bfcc3a-db2c-424c-b029-7fe99a87c641}' -Value 1 -Type 'DWord';
		Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\ClassicStartMenu' -Name '{a8cdff1c-4878-43be-b5fd-f8091c1c60d0}' -Value 1 -Type 'DWord';
		Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\ClassicStartMenu' -Name '{374de290-123f-4565-9164-39c4925e467b}' -Value 1 -Type 'DWord';
		Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\ClassicStartMenu' -Name '{e88865ea-0e1c-4e20-9aa6-edcd0212c87c}' -Value 1 -Type 'DWord';
		Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\ClassicStartMenu' -Name '{f874310e-b6b7-47dc-bc84-b9e6b38f5903}' -Value 1 -Type 'DWord';
		Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\ClassicStartMenu' -Name '{1cf1260c-4dd0-4ebb-811f-33c572699fde}' -Value 1 -Type 'DWord';
		Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\ClassicStartMenu' -Name '{f02c1a0d-be21-4350-88b0-7367fc96ef3c}' -Value 1 -Type 'DWord';
		Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\ClassicStartMenu' -Name '{3add1653-eb32-4cb0-bbd7-dfa0abb5acca}' -Value 1 -Type 'DWord';
		Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\ClassicStartMenu' -Name '{645ff040-5081-101b-9f08-00aa002f954e}' -Value 0 -Type 'DWord';
		Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\ClassicStartMenu' -Name '{20d04fe0-3aea-1069-a2d8-08002b30309d}' -Value 1 -Type 'DWord';
		Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\ClassicStartMenu' -Name '{59031a47-3f72-44a7-89c5-5595fe6b30ee}' -Value 1 -Type 'DWord';
		Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\ClassicStartMenu' -Name '{a0953c92-50dc-43bf-be83-3742fed03c9c}' -Value 1 -Type 'DWord';
		New-Item -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\NewStartPanel' -Force;
		Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\NewStartPanel' -Name '{5399e694-6ce5-4d6c-8fce-1d8870fdcba0}' -Value 0 -Type 'DWord';
		Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\NewStartPanel' -Name '{b4bfcc3a-db2c-424c-b029-7fe99a87c641}' -Value 1 -Type 'DWord';
		Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\NewStartPanel' -Name '{a8cdff1c-4878-43be-b5fd-f8091c1c60d0}' -Value 1 -Type 'DWord';
		Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\NewStartPanel' -Name '{374de290-123f-4565-9164-39c4925e467b}' -Value 1 -Type 'DWord';
		Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\NewStartPanel' -Name '{e88865ea-0e1c-4e20-9aa6-edcd0212c87c}' -Value 1 -Type 'DWord';
		Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\NewStartPanel' -Name '{f874310e-b6b7-47dc-bc84-b9e6b38f5903}' -Value 1 -Type 'DWord';
		Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\NewStartPanel' -Name '{1cf1260c-4dd0-4ebb-811f-33c572699fde}' -Value 1 -Type 'DWord';
		Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\NewStartPanel' -Name '{f02c1a0d-be21-4350-88b0-7367fc96ef3c}' -Value 1 -Type 'DWord';
		Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\NewStartPanel' -Name '{3add1653-eb32-4cb0-bbd7-dfa0abb5acca}' -Value 1 -Type 'DWord';
		Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\NewStartPanel' -Name '{645ff040-5081-101b-9f08-00aa002f954e}' -Value 0 -Type 'DWord';
		Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\NewStartPanel' -Name '{20d04fe0-3aea-1069-a2d8-08002b30309d}' -Value 1 -Type 'DWord';
		Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\NewStartPanel' -Name '{59031a47-3f72-44a7-89c5-5595fe6b30ee}' -Value 1 -Type 'DWord';
		Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\NewStartPanel' -Name '{a0953c92-50dc-43bf-be83-3742fed03c9c}' -Value 1 -Type 'DWord';
	};
	{
		Get-Content -LiteralPath 'C:\Windows\Setup\Scripts\SetColorTheme.ps1' -Raw | Invoke-Expression;
	};
	{
		Get-Process -Name 'explorer' -ErrorAction 'SilentlyContinue' | Where-Object -FilterScript {
			$_.SessionId -eq ( Get-Process -Id $PID ).SessionId;
		} | Stop-Process -Force;
	};
);

&amp; {
  [float] $complete = 0;
  [float] $increment = 100 / $scripts.Count;
  foreach( $script in $scripts ) {
    Write-Progress -Activity 'Running scripts to configure this user account. Do not close this window.' -PercentComplete $complete;
    '*** Will now execute command &#xAB;{0}&#xBB;.' -f $(
      $str = $script.ToString().Trim() -replace '\s+', ' ';
      $max = 100;
      if( $str.Length -le $max ) {
        $str;
      } else {
        $str.Substring( 0, $max - 1 ) + '&#x2026;';
      }
    );
    $start = [datetime]::Now;
    &amp; $script;
    '*** Finished executing command after {0:0} ms.' -f [datetime]::Now.Subtract( $start ).TotalMilliseconds;
    "`r`n" * 3;
    $complete += $increment;
  }
} *&gt;&amp;1 &gt;&gt; "$env:TEMP\UserOnce.log";
		</File>
		<File path="C:\Windows\Setup\Scripts\DefaultUser.ps1">
$scripts = @(
	{
		reg.exe add "HKU\DefaultUser\Software\Policies\Microsoft\Windows\WindowsCopilot" /v TurnOffWindowsCopilot /t REG_DWORD /d 1 /f;
	};
	{
		reg.exe add "HKU\DefaultUser\Software\Microsoft\Notepad" /v ShowStoreBanner /t REG_DWORD /d 0 /f;
	};
	{
		Remove-ItemProperty -LiteralPath 'Registry::HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Run' -Name 'OneDriveSetup' -Force -ErrorAction 'Continue';
	};
	{
		reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\GameDVR" /v AppCaptureEnabled /t REG_DWORD /d 0 /f;
	};
	{
		reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "HideFileExt" /t REG_DWORD /d 0 /f;
	};
	{
		reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "Hidden" /t REG_DWORD /d 1 /f;
	};
	{
		reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v ShowTaskViewButton /t REG_DWORD /d 0 /f;
	};
	{
		reg.exe add "HKU\DefaultUser\Software\Microsoft\Edge\SmartScreenEnabled" /ve /t REG_DWORD /d 0 /f;
		reg.exe add "HKU\DefaultUser\Software\Microsoft\Edge\SmartScreenPuaEnabled" /ve /t REG_DWORD /d 0 /f;
		reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\AppHost" /v EnableWebContentEvaluation /t REG_DWORD /d 0 /f;
		reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\AppHost" /v PreventOverride /t REG_DWORD /d 0 /f;
	};
	{
		$names = @(
		  'ContentDeliveryAllowed';
		  'FeatureManagementEnabled';
		  'OEMPreInstalledAppsEnabled';
		  'PreInstalledAppsEnabled';
		  'PreInstalledAppsEverEnabled';
		  'SilentInstalledAppsEnabled';
		  'SoftLandingEnabled';
		  'SubscribedContentEnabled';
		  'SubscribedContent-310093Enabled';
		  'SubscribedContent-338387Enabled';
		  'SubscribedContent-338388Enabled';
		  'SubscribedContent-338389Enabled';
		  'SubscribedContent-338393Enabled';
		  'SubscribedContent-353698Enabled';
		  'SystemPaneSuggestionsEnabled';
		);
		
		foreach( $name in $names ) {
		  reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v $name /t REG_DWORD /d 0 /f;
		}
	};
	{
		reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v TaskbarAl /t REG_DWORD /d 0 /f;
	};
	{
		foreach( $root in 'Registry::HKU\.DEFAULT', 'Registry::HKU\DefaultUser' ) {
		  Set-ItemProperty -LiteralPath "$root\Control Panel\Keyboard" -Name 'InitialKeyboardIndicators' -Type 'String' -Value 2 -Force;
		}
	};
	{
		$params = @{
		  LiteralPath = 'Registry::HKU\DefaultUser\Control Panel\Mouse';
		  Type = 'String';
		  Value = 0;
		  Force = $true;
		};
		Set-ItemProperty @params -Name 'MouseSpeed';
		Set-ItemProperty @params -Name 'MouseThreshold1';
		Set-ItemProperty @params -Name 'MouseThreshold2';
	};
	{
		reg.exe add "HKU\DefaultUser\Software\Policies\Microsoft\Windows\Explorer" /v DisableSearchBoxSuggestions /t REG_DWORD /d 1 /f;
	};
	{
		reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\DWM" /v ColorPrevalence /t REG_DWORD /d 0 /f;
	};
	{
		reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\RunOnce" /v "UnattendedSetup" /t REG_SZ /d "powershell.exe -WindowStyle Hidden -NoProfile -Command \""Get-Content -LiteralPath 'C:\Windows\Setup\Scripts\UserOnce.ps1' -Raw | Invoke-Expression;\""" /f;
	};
);

&amp; {
  [float] $complete = 0;
  [float] $increment = 100 / $scripts.Count;
  foreach( $script in $scripts ) {
    Write-Progress -Activity 'Running scripts to modify the default user&#x2019;&#x2019;s registry hive. Do not close this window.' -PercentComplete $complete;
    '*** Will now execute command &#xAB;{0}&#xBB;.' -f $(
      $str = $script.ToString().Trim() -replace '\s+', ' ';
      $max = 100;
      if( $str.Length -le $max ) {
        $str;
      } else {
        $str.Substring( 0, $max - 1 ) + '&#x2026;';
      }
    );
    $start = [datetime]::Now;
    &amp; $script;
    '*** Finished executing command after {0:0} ms.' -f [datetime]::Now.Subtract( $start ).TotalMilliseconds;
    "`r`n" * 3;
    $complete += $increment;
  }
} *&gt;&amp;1 &gt;&gt; "C:\Windows\Setup\Scripts\DefaultUser.log";
		</File>
		<File path="C:\Windows\Setup\Scripts\FirstLogon.ps1">
$scripts = @(
	{
		Set-ItemProperty -LiteralPath 'Registry::HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon' -Name 'AutoLogonCount' -Type 'DWord' -Force -Value 0;
	};
	{
		Disable-ComputerRestore -Drive 'C:\';
	};
	{
		Get-Content -LiteralPath 'C:\Windows\Setup\Scripts\VMwareTools.ps1' -Raw | Invoke-Expression;
	};
	{
		Get-Content -LiteralPath 'C:\Windows\Setup\Scripts\VirtIoGuestTools.ps1' -Raw | Invoke-Expression;
	};
	{
		Get-Content -LiteralPath 'C:\Windows\Setup\Scripts\unattend-02.ps1' -Raw | Invoke-Expression;
	};
	{
		Get-Content -LiteralPath 'C:\Windows\Setup\Scripts\unattend-03.ps1' -Raw | Invoke-Expression;
	};
	{
		Get-Content -LiteralPath 'C:\Windows\Setup\Scripts\unattend-04.ps1' -Raw | Invoke-Expression;
	};
	{
		Get-Content -LiteralPath 'C:\Windows\Setup\Scripts\unattend-05.ps1' -Raw | Invoke-Expression;
	};
	{
		Get-Content -LiteralPath 'C:\Windows\Setup\Scripts\unattend-06.ps1' -Raw | Invoke-Expression;
	};
	{
		Get-Content -LiteralPath 'C:\Windows\Setup\Scripts\unattend-07.ps1' -Raw | Invoke-Expression;
	};
	{
		Get-Content -LiteralPath 'C:\Windows\Setup\Scripts\unattend-08.ps1' -Raw | Invoke-Expression;
	};
);

&amp; {
  [float] $complete = 0;
  [float] $increment = 100 / $scripts.Count;
  foreach( $script in $scripts ) {
    Write-Progress -Activity 'Running scripts to finalize your Windows installation. Do not close this window.' -PercentComplete $complete;
    '*** Will now execute command &#xAB;{0}&#xBB;.' -f $(
      $str = $script.ToString().Trim() -replace '\s+', ' ';
      $max = 100;
      if( $str.Length -le $max ) {
        $str;
      } else {
        $str.Substring( 0, $max - 1 ) + '&#x2026;';
      }
    );
    $start = [datetime]::Now;
    &amp; $script;
    '*** Finished executing command after {0:0} ms.' -f [datetime]::Now.Subtract( $start ).TotalMilliseconds;
    "`r`n" * 3;
    $complete += $increment;
  }
} *&gt;&amp;1 &gt;&gt; "C:\Windows\Setup\Scripts\FirstLogon.log";
		</File>
	</Extensions>
</unattend>